<!DOCTYPE html>
<html lang="lt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EV Docs LT - Elektromobilių krovimo stotelės dokumentai</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
    body { font-family: 'Inter', sans-serif; }
  </style>
</head>
<body class="bg-gray-50">
  <div id="app"></div>

  <script>
    // State management
    let state = {
      page: 'landing', // 'landing', 'form', 'result'
      step: 0,
      errors: {},
      files: {
        propertyDeed: null,
        coOwnerConsent: null,
        esoConditions: null,
        landlordConsent: null
      },
      data: {
        fullName: '',
        personalCode: '',
        phone: '',
        email: '',
        address: '',
        apartmentNumber: '',
        propertyType: '',
        ownership: '',
        parkingSpot: '',
        parkingLocation: '',
        chargerType: '',
        power: '',
        connectors: '1',
        chargerModel: '',
        hasCoOwnerConsent: ''
      }
    };

    const steps = [
      { title: 'Asmeninė informacija', fields: ['fullName', 'personalCode', 'phone', 'email'] },
      { title: 'Turto informacija', fields: ['address', 'propertyType', 'ownership', 'apartmentNumber'] },
      { title: 'Parkavimo vieta', fields: ['parkingLocation', 'parkingSpot'] },
      { title: 'Stotelės parametrai', fields: ['chargerType', 'power', 'connectors'] },
      { title: 'Dokumentai', fields: ['hasCoOwnerConsent'] }
    ];

    function validateStep() {
      const currentFields = steps[state.step].fields;
      const newErrors = {};
      
      currentFields.forEach(field => {
        if (field === 'apartmentNumber' && state.data.propertyType !== 'apartment') return;
        if (field === 'parkingSpot' && state.data.propertyType !== 'apartment') return;
        if (field === 'hasCoOwnerConsent' && state.data.propertyType !== 'apartment') return;
        
        if (!state.data[field] || state.data[field].trim() === '') {
          newErrors[field] = 'Šis laukas yra privalomas';
        }
      });
      
      if (state.step === 0) {
        if (state.data.personalCode && !/^\d{11}$/.test(state.data.personalCode)) {
          newErrors.personalCode = 'Asmens kodas turi būti 11 skaitmenų';
        }
        if (state.data.phone && !/^\+?370\s?\d{8}$/.test(state.data.phone.replace(/\s/g, ''))) {
          newErrors.phone = 'Neteisingas telefono formatas (+370 XXXXXXXX)';
        }
        if (state.data.email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(state.data.email)) {
          newErrors.email = 'Neteisingas el. pašto formatas';
        }
      }
      
      state.errors = newErrors;
      return Object.keys(newErrors).length === 0;
    }

    function generateDocument() {
      const d = state.data;
      const isApartment = d.propertyType === 'apartment';
      const needsCoOwnerDocs = isApartment && d.hasCoOwnerConsent === 'no';
      
      return `═══════════════════════════════════════════════════════════════
                    EV DOCS LT - SUGENERUOTI DOKUMENTAI
═══════════════════════════════════════════════════════════════

DOKUMENTAS #1: PAREIŠKIMAS DĖL EV ĮKROVIMO STOTELĖS ĮRENGIMO

${new Date().toLocaleDateString('lt-LT')}

${isApartment ? `Daugiabučio namo ${d.address}
Butų ir kitų patalpų savininkams` : `Pareiškimas dėl elektromobilio įkrovimo stotelės įrengimo
${d.address}`}

Pareiškėjas: ${d.fullName}
Gyvenamoji vieta: ${d.address}
Asmens kodas: ${d.personalCode}
Tel.: ${d.phone}
El. paštas: ${d.email}

${isApartment ? 'PRAŠAU LEISTI ĮRENGTI ELEKTROMOBILIO ĮKROVIMO STOTELĘ' : 'PAREIŠKIMAS DĖL EV STOTELĖS ĮRENGIMO'}

1. Aš, ${d.fullName}, esu ${isApartment ? `buto Nr. ${d.apartmentNumber}` : 'namo'} 
   ${d.ownership === 'owner' ? 'savininkas(-ė)' : 'nuomininkas(-ė)'} adresu ${d.address}.

2. ${isApartment ? 'Prašau Jūsų sutikimo įrengti' : 'Informuoju apie ketinimą įrengti'} elektromobilio įkrovimo stotelę 
   ${isApartment ? `man priklausančioje parkavimo vietoje Nr. ${d.parkingSpot}` : 'savo teritorijoje'}, 
   esančioje ${d.parkingLocation}.

3. Įrengiamos stotelės parametrai:
   - Tipas: ${d.chargerType}
   - Galia: ${d.power} kW
   - Prieigų skaičius: ${d.connectors}
   - Gamintojo modelis: ${d.chargerModel || 'bus nurodyta vėliau'}

Įsipareigoju laikytis visų teisės aktų reikalavimų ir užtikrinti saugų eksploatavimą.

Pareiškėjas: _________________ (${d.fullName})

${new Date().toLocaleDateString('lt-LT')}

${needsCoOwnerDocs ? `
═══════════════════════════════════════════════════════════════

DOKUMENTAS #2: BENDRASAVININKŲ SUTIKIMO ŠABLONAS

Daugiabučio namo ${d.address}

BENDRASAVININKŲ SUTIKIMAS
DĖL ELEKTROMOBILIO ĮKROVIMO STOTELĖS ĮRENGIMO

Mes, žemiau pasirašę butų savininkai, SUTINKAME, 
kad ${d.fullName}, buto Nr. ${d.apartmentNumber} 
savininkas(-ė), įrengtų elektromobilio įkrovimo stotelę 
parkavimo vietoje Nr. ${d.parkingSpot}.

Bendrasavininkų sąrašas:

Nr. | Buto Nr. | Savininkas | Asmens kodas | Parašas | Data
----|----------|------------|--------------|---------|------
1.  |          |            |              |         |
2.  |          |            |              |         |
3.  |          |            |              |         |
` : ''}

═══════════════════════════════════════════════════════════════
TOLIMESNI ŽINGSNIAI:

${needsCoOwnerDocs ? '1. ✓ Surinkti bendrasavininkų parašus' : '1. ✓ Paruošti sutikimus'}
2. ☐ Gauti NT registro išrašą (www.registrucentras.lt)
3. ☐ Kreiptis į ESO dėl prijungimo sąlygų (www.eso.lt, tel. 1852)
4. ☐ Pateikti paraišką ENA (www.ena.lt)

PARAMA: ${isApartment ? '60%' : '40%'} įrengimo išlaidų (maks. 1,500 EUR)

Sugeneruota: ${new Date().toLocaleString('lt-LT')}
Sistema: EV Docs LT v1.0 MVP
═══════════════════════════════════════════════════════════════`;
    }

    function downloadDocuments(event) {
      if (event) event.preventDefault();
      
      const d = state.data;
      const isApartment = d.propertyType === 'apartment';
      const needsCoOwnerDocs = isApartment && d.hasCoOwnerConsent === 'no';
      const hasCoOwnerDocs = d.hasCoOwnerConsent === 'yes';
      
      // Create HTML content with proper Lithuanian character support
      const htmlContent = `
        <div style="font-family: Arial, sans-serif; padding: 20px; font-size: 11px; line-height: 1.5;">
          <!-- Header -->
          <div style="background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); color: white; padding: 20px; text-align: center; margin: -20px -20px 20px -20px;">
            <h1 style="margin: 0; font-size: 24px; font-weight: bold;">EV DOCS LT</h1>
            <p style="margin: 5px 0 0 0; font-size: 14px;">Elektromobilių krovimo stotelės dokumentai</p>
            <p style="margin: 5px 0 0 0; font-size: 10px;">${new Date().toLocaleDateString('lt-LT')}</p>
          </div>
          
          <!-- Document 1: Pareiškimas -->
          <div style="background: #f3f4f6; padding: 8px; margin: 20px 0 10px 0;">
            <h2 style="margin: 0; font-size: 16px; font-weight: bold;">DOKUMENTAS #1: PAREIŠKIMAS</h2>
          </div>
          
          <h3 style="text-align: center; font-size: 13px; margin: 15px 0;">Dėl elektromobilio įkrovimo stotelės įrengimo</h3>
          
          ${isApartment ? `
            <p><strong>Daugiabučio namo ${d.address}</strong></p>
            <p>Butų ir kitų patalpų savininkams</p>
          ` : `
            <p><strong>Adresas:</strong> ${d.address}</p>
          `}
          
          <h4 style="margin-top: 20px; font-size: 12px; font-weight: bold;">PAREIŠKĖJO DUOMENYS:</h4>
          <p><strong>Vardas, pavardė:</strong> ${d.fullName}</p>
          <p><strong>Asmens kodas:</strong> ${d.personalCode}</p>
          <p><strong>Adresas:</strong> ${d.address}</p>
          ${isApartment ? `<p><strong>Buto numeris:</strong> ${d.apartmentNumber}</p>` : ''}
          <p><strong>Telefonas:</strong> ${d.phone}</p>
          <p><strong>El. paštas:</strong> ${d.email}</p>
          
          <h4 style="margin-top: 20px; font-size: 12px; font-weight: bold;">
            ${isApartment ? 'PRAŠAU LEISTI ĮRENGTI:' : 'INFORMUOJU APIE KETINIMĄ ĮRENGTI:'}
          </h4>
          <p>Elektromobilio įkrovimo stotelę ${isApartment ? 'parkavimo vietoje Nr. ' + d.parkingSpot : 'savo teritorijoje'}, esančioje ${d.parkingLocation}.</p>
          
          <h4 style="margin-top: 20px; font-size: 12px; font-weight: bold;">STOTELĖS PARAMETRAI:</h4>
          <ul style="margin: 5px 0; padding-left: 20px;">
            <li>Tipas: ${d.chargerType}</li>
            <li>Galia: ${d.power} kW</li>
            <li>Prieigų skaičius: ${d.connectors}</li>
            ${d.chargerModel ? `<li>Modelis: ${d.chargerModel}</li>` : ''}
          </ul>
          
          <h4 style="margin-top: 20px; font-size: 12px; font-weight: bold;">ĮSIPAREIGOJIMAI:</h4>
          <ul style="margin: 5px 0; padding-left: 20px;">
            <li>Laikytis visų Lietuvos Respublikos statybos ir elektros saugos reikalavimų</li>
            <li>Naudoti tik sertifikuotą ir naują įrangą</li>
            <li>Įrengimo darbus pavesti atestuotam rangovui su VERT atestu</li>
            <li>Tinkamai eksploatuoti ir prižiūrėti įrengtą stotelę</li>
            ${isApartment ? '<li>Kompensuoti žalą bendriesiems objektams, jei tokia atsiras</li>' : ''}
          </ul>
          
          <div style="margin-top: 40px;">
            <p>Pareiškėjas: ___________________________</p>
            <p style="margin-left: 80px;">(${d.fullName})</p>
            <p>Data: ${new Date().toLocaleDateString('lt-LT')}</p>
          </div>
          
          ${needsCoOwnerDocs ? `
            <div style="page-break-before: always; padding-top: 20px;">
              <div style="background: #f3f4f6; padding: 8px; margin: 0 0 10px 0;">
                <h2 style="margin: 0; font-size: 16px; font-weight: bold;">DOKUMENTAS #2: BENDRASAVININKŲ SUTIKIMAS</h2>
              </div>
              
              <h3 style="text-align: center; font-size: 13px; margin: 15px 0;">
                Daugiabučio namo ${d.address}<br/>
                BENDRASAVININKŲ SUTIKIMAS<br/>
                DĖL EV ĮKROVIMO STOTELĖS ĮRENGIMO
              </h3>
              
              <p>Mes, žemiau pasirašę daugiabučio namo butų ir kitų patalpų savininkai, <strong>SUTINKAME</strong>, kad ${d.fullName}, buto Nr. ${d.apartmentNumber} savininkas(-ė), įrengtų elektromobilio įkrovimo stotelę parkavimo vietoje Nr. ${d.parkingSpot}.</p>
              
              <h4 style="margin-top: 20px; font-size: 12px; font-weight: bold;">STOTELĖS PARAMETRAI:</h4>
              <ul style="margin: 5px 0; padding-left: 20px;">
                <li>Galia: ${d.power} kW</li>
                <li>Tipas: ${d.chargerType}</li>
                <li>Prieigų skaičius: ${d.connectors}</li>
              </ul>
              
              <h4 style="margin-top: 20px; font-size: 12px; font-weight: bold;">SĄLYGOS:</h4>
              <ol style="margin: 5px 0; padding-left: 20px;">
                <li>Stotelė bus įrengta pagal LR statybos ir elektros įrenginių reikalavimus</li>
                <li>Bus naudojama tik sertifikuota ir nauja įranga</li>
                <li>Darbai bus atliekami atestuoto rangovo su VERT atestu</li>
                <li>Bus gautos ir įvykdytos ESO prijungimo sąlygos</li>
                <li>Pareiškėjas įsipareigoja kompensuoti žalą, jei tokia atsiras</li>
              </ol>
              
              <h4 style="margin-top: 20px; font-size: 12px; font-weight: bold;">BENDRASAVININKŲ PARAŠŲ LENTELĖ:</h4>
              
              <table style="width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 10px;">
                <thead>
                  <tr style="background: #e5e7eb;">
                    <th style="border: 1px solid #999; padding: 5px; text-align: left;">Nr.</th>
                    <th style="border: 1px solid #999; padding: 5px; text-align: left;">Buto Nr.</th>
                    <th style="border: 1px solid #999; padding: 5px; text-align: left;">Savininkas (V.P.)</th>
                    <th style="border: 1px solid #999; padding: 5px; text-align: left;">Asmens kodas</th>
                    <th style="border: 1px solid #999; padding: 5px; text-align: left;">Parašas</th>
                    <th style="border: 1px solid #999; padding: 5px; text-align: left;">Data</th>
                  </tr>
                </thead>
                <tbody>
                  ${Array.from({length: 10}, (_, i) => `
                    <tr>
                      <td style="border: 1px solid #999; padding: 5px;">${i+1}.</td>
                      <td style="border: 1px solid #999; padding: 5px;">&nbsp;</td>
                      <td style="border: 1px solid #999; padding: 5px;">&nbsp;</td>
                      <td style="border: 1px solid #999; padding: 5px;">&nbsp;</td>
                      <td style="border: 1px solid #999; padding: 5px;">&nbsp;</td>
                      <td style="border: 1px solid #999; padding: 5px;">&nbsp;</td>
                    </tr>
                  `).join('')}
                </tbody>
              </table>
              
              <p style="margin-top: 15px; font-size: 9px; font-style: italic;">
                <strong>PASTABA:</strong> Pagal Civilinį kodeksą (4.75 str.), reikia VISŲ savininkų sutikimo.
              </p>
            </div>
          ` : ''}
          
          <!-- Instructions page -->
          <div style="page-break-before: always; padding-top: 0;">
            <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 15px; text-align: center; margin: -20px -20px 20px -20px;">
              <h2 style="margin: 0; font-size: 18px; font-weight: bold;">INSTRUKCIJOS IR TOLIMESNI ŽINGSNIAI</h2>
            </div>
            
            <div style="margin: 20px 0;">
              <div style="background: #dbeafe; border-left: 4px solid #2563eb; padding: 12px; margin: 15px 0;">
                <h4 style="margin: 0 0 8px 0; font-size: 12px;">
                  <span style="background: #2563eb; color: white; border-radius: 50%; padding: 2px 8px; margin-right: 8px;">1</span>
                  ${isApartment ? 'Surinkite bendrasavininkų sutikimus' : 'Paruoškite dokumentus'}
                </h4>
                <p style="margin: 0; font-size: 10px;">
                  ${needsCoOwnerDocs ? 
                    'Naudokite šiame PDF esantį šabloną (Dokumentas #2). Surinkite visų bendrasavininkų parašus arba sušaukite bendrą susirinkimą ir patvirtinkite sprendimą protokolu. Laikas: 1-4 savaitės.' :
                    hasCoOwnerDocs ? 'Jūsų turimas sutikimas jau yra tinkamas - įkelkite jį sistemoje.' :
                    'Individualiems namams nereikia bendrasavininkų sutikimo - pereikite prie kito žingsnio.'}
                </p>
              </div>
              
              <div style="background: #fef3c7; border-left: 4px solid #f59e0b; padding: 12px; margin: 15px 0;">
                <h4 style="margin: 0 0 8px 0; font-size: 12px;">
                  <span style="background: #f59e0b; color: white; border-radius: 50%; padding: 2px 8px; margin-right: 8px;">2</span>
                  Gaukite NT registro išrašą
                </h4>
                <p style="margin: 0; font-size: 10px;">
                  <strong>Kaip gauti:</strong><br/>
                  • Internetu: <strong>www.registrucentras.lt/paslaugos</strong> (reikia prisijungti per el. valdžios vartus)<br/>
                  • Tel.: 1884 (darbo dienomis 8-17 val.)<br/>
                  • Kaina: 2-3 EUR<br/>
                  • Trukmė: Iš karto (elektroninis) arba 1-3 d.d. (popierinis)<br/>
                  • Reikalingas: Nekilnojamojo turto registro išrašas (pilna forma)
                </p>
              </div>
              
              <div style="background: #e0e7ff; border-left: 4px solid #6366f1; padding: 12px; margin: 15px 0;">
                <h4 style="margin: 0 0 8px 0; font-size: 12px;">
                  <span style="background: #6366f1; color: white; border-radius: 50%; padding: 2px 8px; margin-right: 8px;">3</span>
                  Kreipkitės į ESO dėl prijungimo sąlygų
                </h4>
                <p style="margin: 0; font-size: 10px;">
                  <strong>Kaip gauti:</strong><br/>
                  • Internetu: <strong>www.eso.lt</strong> > Paslaugos > Naujo objekto prijungimas<br/>
                  • Tel.: <strong>1852</strong> (darbo dienomis 8-17 val.)<br/>
                  • Trukmė: 5-10 darbo dienų<br/>
                  • Kaina: Nemokama<br/>
                  • Reikalingi dokumentai: Pareiškimas (1 dok.), NT išrašas, techninė specifikacija
                </p>
              </div>
              
              <div style="background: #f3e8ff; border-left: 4px solid #a855f7; padding: 12px; margin: 15px 0;">
                <h4 style="margin: 0 0 8px 0; font-size: 12px;">
                  <span style="background: #a855f7; color: white; border-radius: 50%; padding: 2px 8px; margin-right: 8px;">4</span>
                  Pasirinkite rangovą su VERT atestu
                </h4>
                <p style="margin: 0; font-size: 10px;">
                  <strong>Rangovai (pavyzdžiai):</strong><br/>
                  • Charge In: www.chargein.lt, +370 612 77700<br/>
                  • Solet Technics: www.solet.lt, +370 614 51775<br/>
                  • Elektrum: www.elektrum.lt<br/>
                  • VERT atestuotų elektrikų sąrašas: <strong>www.vert.lt</strong>
                </p>
              </div>
              
              <div style="background: #dcfce7; border-left: 4px solid #10b981; padding: 12px; margin: 15px 0;">
                <h4 style="margin: 0 0 8px 0; font-size: 12px;">
                  <span style="background: #10b981; color: white; border-radius: 50%; padding: 2px 8px; margin-right: 8px;">5</span>
                  Atlikite įrengimo darbus
                </h4>
                <p style="margin: 0; font-size: 10px;">
                  Trukmė: 1-3 dienos (priklauso nuo vietos ir kabelio ilgio)<br/>
                  Kaina: 800-2000 EUR (+ stotelė 500-1500 EUR)<br/>
                  <strong>Svarbu:</strong> Rangovas privalo turėti VERT atestą ir pateikti visus reikalingus sertifikatus!
                </p>
              </div>
              
              <div style="background: #fef2f2; border-left: 4px solid #ef4444; padding: 12px; margin: 15px 0;">
                <h4 style="margin: 0 0 8px 0; font-size: 12px;">
                  <span style="background: #ef4444; color: white; border-radius: 50%; padding: 2px 8px; margin-right: 8px;">6</span>
                  Gauti ESO priėmimo aktą
                </h4>
                <p style="margin: 0; font-size: 10px;">
                  Po darbų užbaigimo ESO atliks patikrinimą ir išduos priėmimo aktą.<br/>
                  Trukmė: 3-5 darbo dienos po kreipimosi<br/>
                  Kaina: Nemokama
                </p>
              </div>
              
              <div style="background: #fef9c3; border-left: 4px solid #eab308; padding: 12px; margin: 15px 0;">
                <h4 style="margin: 0 0 8px 0; font-size: 12px;">
                  <span style="background: #eab308; color: white; border-radius: 50%; padding: 2px 8px; margin-right: 8px;">7</span>
                  Prašykite ENA subsidijos
                </h4>
                <p style="margin: 0; font-size: 10px;">
                  <strong>Subsidijos dydis:</strong><br/>
                  • Daugiabučiams: iki 60% (maks. 1,500 EUR)<br/>
                  • Privatiems namams: iki 40% (maks. 1,500 EUR)<br/>
                  <br/>
                  <strong>Dokumentai reikalingi ENA:</strong><br/>
                  • Šis pareiškimas (#1)<br/>
                  • NT išrašas<br/>
                  • Bendrasavininkų sutikimas (jei daugiabučiame name)<br/>
                  • ESO prijungimo sąlygos ir priėmimo aktas<br/>
                  • Rangos sutartis ir sąskaitos<br/>
                  • Stotelės sertifikatai<br/>
                  <br/>
                  <strong>Kreipimasis:</strong> <strong>www.ena.lt</strong> arba el. paštas: <strong>info@ena.lt</strong><br/>
                  <br/>
                  <strong style="color: #dc2626;">⚠️ SVARBU:</strong> Programa galioja iki 2025 m. rugsėjo! Skubėkite!
                </p>
              </div>
            </div>
            
            <div style="background: #f9fafb; border: 1px solid #e5e7eb; padding: 15px; margin-top: 20px;">
              <h4 style="margin: 0 0 10px 0; font-size: 12px; font-weight: bold;">📞 KONTAKTAI</h4>
              <div style="font-size: 10px; line-height: 1.6;">
                <p><strong>ENA (Energetikos agentūra):</strong> www.ena.lt, info@ena.lt</p>
                <p><strong>ESO (Elektros skirstymo operatorius):</strong> www.eso.lt, tel. 1852</p>
                <p><strong>Registrų centras:</strong> www.registrucentras.lt, tel. 1884</p>
                <p><strong>VERT (Valstybinė energetikos reguliavimo taryba):</strong> www.vert.lt</p>
              </div>
            </div>
          </div>
        </div>
      `;
      
      // Generate PDF using html2pdf
      const opt = {
        margin: 0,
        filename: `ev-docs-${d.fullName.replace(/\s+/g, '-')}.pdf`,
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2, useCORS: true },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };
      
      html2pdf().set(opt).from(htmlContent).save();
    }

    function allDocsUploaded() {
      const isApartment = state.data.propertyType === 'apartment';
      const pageHeight = doc.internal.pageSize.height;
      const margin = 20;
      const maxWidth = pageWidth - 2 * margin;
      
      // Helper functions
      const addText = (text, size = 10, style = 'normal', align = 'left') => {
        doc.setFontSize(size);
        doc.setFont('helvetica', style);
        if (align === 'center') {
          doc.text(text, pageWidth / 2, y, { align: 'center' });
        } else {
          const lines = doc.splitTextToSize(text, maxWidth);
          doc.text(lines, margin, y);
          y += lines.length * (size * 0.35);
        }
        y += size * 0.2;
      };
      
      const addLine = () => {
        doc.setDrawColor(200, 200, 200);
        doc.line(margin, y, pageWidth - margin, y);
        y += 5;
      };
      
      const checkPageBreak = (space = 20) => {
        if (y + space > pageHeight - margin) {
          doc.addPage();
          y = margin;
        }
      };
      
      // Title
      doc.setFillColor(37, 99, 235);
      doc.rect(0, 0, pageWidth, 40, 'F');
      doc.setTextColor(255, 255, 255);
      doc.setFontSize(20);
      doc.setFont('helvetica', 'bold');
      doc.text('EV DOCS LT', pageWidth / 2, 15, { align: 'center' });
      doc.setFontSize(12);
      doc.text('Elektromobilių krovimo stotelės dokumentai', pageWidth / 2, 25, { align: 'center' });
      doc.setFontSize(9);
      doc.text(new Date().toLocaleDateString('lt-LT'), pageWidth / 2, 32, { align: 'center' });
      
      doc.setTextColor(0, 0, 0);
      y = 50;
      
      // DOKUMENTAS 1: PAREIŠKIMAS
      doc.setFillColor(243, 244, 246);
      doc.rect(margin, y, maxWidth, 10, 'F');
      doc.setFontSize(14);
      doc.setFont('helvetica', 'bold');
      doc.text('DOKUMENTAS #1: PAREIŠKIMAS', margin + 5, y + 7);
      y += 15;
      
      addText(`Dėl elektromobilio įkrovimo stotelės įrengimo`, 11, 'bold', 'center');
      y += 5;
      
      if (isApartment) {
        addText(`Daugiabučio namo ${d.address}`);
        addText('Butų ir kitų patalpų savininkams');
      } else {
        addText(`Adresas: ${d.address}`);
      }
      y += 5;
      
      addText('PAREIŠKĖJO DUOMENYS:', 11, 'bold');
      addText(`Vardas, pavardė: ${d.fullName}`);
      addText(`Asmens kodas: ${d.personalCode}`);
      addText(`Adresas: ${d.address}`);
      if (isApartment) addText(`Buto numeris: ${d.apartmentNumber}`);
      addText(`Telefonas: ${d.phone}`);
      addText(`El. paštas: ${d.email}`);
      y += 5;
      
      addText(isApartment ? 'PRAŠAU LEISTI ĮRENGTI:' : 'INFORMUOJU APIE KETINIMĄ ĮRENGTI:', 11, 'bold');
      addText(`Elektromobilio įkrovimo stotelę ${isApartment ? 'parkavimo vietoje Nr. ' + d.parkingSpot : 'savo teritorijoje'}, esančioje ${d.parkingLocation}.`);
      y += 3;
      
      addText('STOTELĖS PARAMETRAI:', 11, 'bold');
      addText(`• Tipas: ${d.chargerType}`);
      addText(`• Galia: ${d.power} kW`);
      addText(`• Prieigų skaičius: ${d.connectors}`);
      if (d.chargerModel) addText(`• Modelis: ${d.chargerModel}`);
      y += 5;
      
      addText('ĮSIPAREIGOJIMAI:', 11, 'bold');
      addText('• Laikytis visų Lietuvos Respublikos statybos ir elektros saugos reikalavimų');
      addText('• Naudoti tik sertifikuotą ir naują įrangą');
      addText('• Įrengimo darbus pavesti atestuotam rangovui su VERT atestu');
      addText('• Tinkamai eksploatuoti ir prižiūrėti įrengtą stotelę');
      if (isApartment) addText('• Kompensuoti žalą bendriesiems objektams, jei tokia atsiras');
      y += 10;
      
      addText('Pareiškėjas: ___________________________');
      addText(`                    (${d.fullName})`);
      addText(`Data: ${new Date().toLocaleDateString('lt-LT')}`);
      
      checkPageBreak(40);
      y += 10;
      addLine();
      y += 5;
      
      // DOKUMENTAS 2: BENDRASAVININKŲ SUTIKIMAS (jei reikia)
      if (needsCoOwnerDocs) {
        checkPageBreak(100);
        
        doc.setFillColor(243, 244, 246);
        doc.rect(margin, y, maxWidth, 10, 'F');
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('DOKUMENTAS #2: BENDRASAVININKŲ SUTIKIMAS', margin + 5, y + 7);
        y += 15;
        
        addText(`Daugiabučio namo ${d.address}`, 11, 'bold', 'center');
        addText('BENDRASAVININKŲ SUTIKIMAS', 11, 'bold', 'center');
        addText('DĖL EV ĮKROVIMO STOTELĖS ĮRENGIMO', 11, 'bold', 'center');
        y += 5;
        
        addText(`Mes, žemiau pasirašę daugiabučio namo butų ir kitų patalpų savininkai, SUTINKAME, kad ${d.fullName}, buto Nr. ${d.apartmentNumber} savininkas(-ė), įrengtų elektromobilio įkrovimo stotelę parkavimo vietoje Nr. ${d.parkingSpot}.`);
        y += 5;
        
        addText('STOTELĖS PARAMETRAI:', 11, 'bold');
        addText(`• Galia: ${d.power} kW`);
        addText(`• Tipas: ${d.chargerType}`);
        addText(`• Prieigų skaičius: ${d.connectors}`);
        y += 5;
        
        addText('SĄLYGOS:', 11, 'bold');
        addText('1. Stotelė bus įrengta pagal LR statybos ir elektros įrenginių reikalavimus');
        addText('2. Bus naudojama tik sertifikuota ir nauja įranga');
        addText('3. Darbai bus atliekami atestuoto rangovo su VERT atestu');
        addText('4. Bus gautos ir įvykdytos ESO prijungimo sąlygos');
        addText('5. Pareiškėjas įsipareigoja kompensuoti žalą, jei tokia atsiras');
        y += 10;
        
        addText('BENDRASAVININKŲ PARAŠŲ LENTELĖ:', 11, 'bold');
        y += 5;
        
        // Lentelė
        const tableY = y;
        const colWidths = [15, 25, 50, 40, 30, 30];
        const rowHeight = 10;
        
        // Header
        doc.setFillColor(230, 230, 230);
        doc.rect(margin, tableY, maxWidth, rowHeight, 'F');
        doc.setFontSize(9);
        doc.setFont('helvetica', 'bold');
        const headers = ['Nr.', 'Buto Nr.', 'Savininkas (V.P.)', 'Asmens kodas', 'Parašas', 'Data'];
        let xPos = margin;
        headers.forEach((header, i) => {
          doc.text(header, xPos + 2, tableY + 7);
          xPos += colWidths[i];
        });
        
        // Rows
        doc.setFont('helvetica', 'normal');
        for (let i = 0; i < 10; i++) {
          const rowY = tableY + (i + 1) * rowHeight;
          doc.rect(margin, rowY, maxWidth, rowHeight);
          xPos = margin;
          colWidths.forEach(width => {
            doc.line(xPos, rowY, xPos, rowY + rowHeight);
            xPos += width;
          });
          doc.text(`${i + 1}.`, margin + 2, rowY + 7);
        }
        
        y = tableY + 11 * rowHeight + 10;
        
        checkPageBreak(30);
        addText('PASTABA: Pagal Civilinį kodeksą (4.75 str.), reikia VISŲ savininkų sutikimo.', 9, 'italic');
      }
      
      // INSTRUKCIJOS
      doc.addPage();
      y = margin;
      
      doc.setFillColor(16, 185, 129);
      doc.rect(0, 0, pageWidth, 30, 'F');
      doc.setTextColor(255, 255, 255);
      doc.setFontSize(16);
      doc.setFont('helvetica', 'bold');
      doc.text('INSTRUKCIJOS IR TOLIMESNI ŽINGSNIAI', pageWidth / 2, 20, { align: 'center' });
      
      doc.setTextColor(0, 0, 0);
      y = 45;
      
      // Žingsniai
      const steps = [
        {
          num: '1',
          title: 'Surinkite bendrasavininkų sutikimus',
          desc: needsCoOwnerDocs ? 
            'Naudokite šiame PDF esantį šabloną (Dokumentas #2). Surinkite visų bendrasavininkų parašus arba sušaukite bendrą susirinkimą ir patvirtinkite sprendimą protokolu.' :
            hasCoOwnerDocs ? 'Jūsų turimas sutikimas jau yra tinkamas - įkelkite jį sistemoje.' :
            'Individualiems namams nereikia bendrasavininkų sutikimo - pereikite prie kito žingsnio.',
          skip: !isApartment
        },
        {
          num: '2',
          title: 'Gaukite NT registro išrašą',
          desc: 'Kaip gauti:\n• Internetu: www.registrucentras.lt/paslaugos (reikia prisijungti per el. valdžios vartus)\n• Kaina: 2-3 EUR\n• Trukmė: Iš karto (elektroninis) arba 1-3 d.d. (popierinis)\n• Reikalingas dokumentas: Nekilnojamojo turto registro išrašas (pilna forma)'
        },
        {
          num: '3',
          title: 'Kreipkitės į ESO dėl prijungimo sąlygų',
          desc: 'Kaip gauti:\n• Internetu: www.eso.lt > Paslaugos > Naujo objekto prijungimas\n• Tel.: 1852 (darbo dienomis 8-17 val.)\n• Trukmė: 5-10 darbo dienų\n• Kaina: Nemokama\n• Reikalingi dokumentai: Pareiškimas (1 dok.), NT išrašas, techninė EV stotelės specifikacija'
        },
        {
          num: '4',
          title: 'Pasirinkite rangovą su VERT atestu',
          desc: 'Rangovai (pavyzdžiai):\n• Charge In: www.chargein.lt, +370 612 77700\n• Solet Technics: www.solet.lt, +370 614 51775\n• Elektrum: www.elektrum.lt\n• Arba ieškokite VERT atestuotų elektrikų sąrašo: www.vert.lt'
        },
        {
          num: '5',
          title: 'Pateikite paraišką ENA paramai',
          desc: 'Prieš įrengimą:\n• Svetainė: www.ena.lt > Parama > EV stotelės\n• Reikalingi dokumentai: Pareiškimas, NT išrašas, ESO sąlygos, sutikimai\n• Laukite patvirtinimo (5-10 d.d.)\n\nPo įrengimo (mokėjimo prašymui):\n• PVM sąskaita faktūra\n• Perdavimo-priėmimo aktas\n• Techninė specifikacija\n• VERT atesto kopija\n• Bandymo protokolai\n• Stotelės nuotraukos'
        }
      ];
      
      steps.forEach(step => {
        if (step.skip) return;
        
        checkPageBreak(50);
        
        // Žingsnio numeris
        doc.setFillColor(37, 99, 235);
        doc.circle(margin + 7, y + 5, 7, 'F');
        doc.setTextColor(255, 255, 255);
        doc.setFontSize(12);
        doc.setFont('helvetica', 'bold');
        doc.text(step.num, margin + 7, y + 7, { align: 'center' });
        
        // Žingsnio tekstas
        doc.setTextColor(0, 0, 0);
        doc.setFontSize(11);
        doc.text(step.title, margin + 20, y + 7);
        
        y += 12;
        doc.setFontSize(9);
        doc.setFont('helvetica', 'normal');
        const descLines = step.desc.split('\n');
        descLines.forEach(line => {
          const wrapped = doc.splitTextToSize(line, maxWidth - 25);
          doc.text(wrapped, margin + 20, y);
          y += wrapped.length * 4;
        });
        
        y += 8;
      });
      
      // Parama info box
      checkPageBreak(60);
      y += 5;
      doc.setFillColor(254, 243, 199);
      doc.rect(margin, y, maxWidth, 45, 'F');
      doc.setDrawColor(251, 191, 36);
      doc.setLineWidth(2);
      doc.rect(margin, y, maxWidth, 45);
      doc.setLineWidth(0.5);
      
      doc.setFontSize(12);
      doc.setFont('helvetica', 'bold');
      doc.text('💰 PARAMA', margin + 5, y + 10);
      
      doc.setFontSize(10);
      doc.setFont('helvetica', 'normal');
      doc.text(`• Dydis: ${isApartment ? '60%' : '40%'} įrengimo išlaidų`, margin + 5, y + 20);
      doc.text('• Maksimali suma: iki 1,500 EUR vienai stotelei', margin + 5, y + 28);
      doc.text('• Programa galioja iki: 2025 m. rugsėjo mėn. (tikslinkite!)', margin + 5, y + 36);
      
      // Footer
      y = pageHeight - 15;
      doc.setFontSize(8);
      doc.setTextColor(128, 128, 128);
      doc.text('Sugeneruota: ' + new Date().toLocaleString('lt-LT'), margin, y);
      doc.text('Sistema: EV Docs LT v1.0 MVP | www.evdocs.lt', pageWidth - margin, y, { align: 'right' });
      
      doc.save(`EV-Docs-${state.data.fullName.replace(/\s+/g, '-')}-${Date.now()}.pdf`);
    }

    function allDocsUploaded() {
      const isApartment = state.data.propertyType === 'apartment';
      const isTenant = state.data.ownership === 'tenant';
      const needsCoOwnerDocs = isApartment && state.data.hasCoOwnerConsent === 'yes';
      
      return state.files.propertyDeed && 
             state.files.esoConditions &&
             (!needsCoOwnerDocs || state.files.coOwnerConsent) &&
             (!isTenant || state.files.landlordConsent);
    }

    function sendToInstitutions(event) {
      if (event) event.preventDefault();
      
      if (confirm('📧 Ar tikrai norite išsiųsti dokumentus į ENA sistemą?')) {
        alert('✅ Dokumentai sėkmingai išsiųsti!\\n\\nParaiškos numeris: EV-' + Date.now() + 
              '\\nEl. paštas: ' + state.data.email + 
              '\\n\\nJūsų paraišką peržiūrės per 5-10 darbo dienų.\\n' +
              '\\n📧 MVP versijoje - tai tik simuliacija.');
      }
    }

    // Render functions
    function renderLanding() {
      return `
        <div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50">
          <nav class="bg-white/80 backdrop-blur-md border-b border-gray-200 sticky top-0 z-50">
            <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
              <div class="flex items-center gap-2">
                <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                </svg>
                <span class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-green-600 bg-clip-text text-transparent">
                  EV Docs LT
                </span>
              </div>
              <button onclick="changePage('form')" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-all">
                Pradėti dabar
              </button>
            </div>
          </nav>

          <div class="max-w-6xl mx-auto px-4 py-20">
            <div class="text-center mb-16">
              <div class="inline-block mb-4">
                <span class="bg-blue-100 text-blue-800 px-4 py-2 rounded-full text-sm font-semibold">
                  🚀 MVP Beta versija
                </span>
              </div>
              <h1 class="text-5xl md:text-6xl font-bold mb-6 leading-tight">
                EV Stotelės Dokumentai
                <br />
                <span class="bg-gradient-to-r from-blue-600 to-green-600 bg-clip-text text-transparent">
                  Per 5 Minutes
                </span>
              </h1>
              <p class="text-xl text-gray-600 mb-8 max-w-2xl mx-auto">
                Automatiškai sugeneruokite visus reikalingus dokumentus elektromobilio 
                krovimo stotelės įrengimui. Sutaupykite laiką ir išvenkite klaidų.
              </p>
              <button onclick="changePage('form')" class="bg-blue-600 text-white px-8 py-4 rounded-lg font-semibold text-lg hover:bg-blue-700 transition-all shadow-lg">
                Sukurti dokumentus →
              </button>
            </div>

            <div class="grid md:grid-cols-3 gap-8 mb-16">
              <div class="bg-white p-8 rounded-2xl shadow-lg">
                <div class="bg-blue-100 w-14 h-14 rounded-lg flex items-center justify-center mb-4">
                  <svg class="w-7 h-7 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
                  </svg>
                </div>
                <h3 class="text-xl font-bold mb-3">Greitas procesas</h3>
                <p class="text-gray-600">
                  Atsakykite į klausimus ir gaukite dokumentus per 5 minutes.
                </p>
              </div>

              <div class="bg-white p-8 rounded-2xl shadow-lg">
                <div class="bg-green-100 w-14 h-14 rounded-lg flex items-center justify-center mb-4">
                  <svg class="w-7 h-7 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                  </svg>
                </div>
                <h3 class="text-xl font-bold mb-3">Teisiškai teisingi</h3>
                <p class="text-gray-600">
                  Visi dokumentai atitinka LT teisės aktų reikalavimus.
                </p>
              </div>

              <div class="bg-white p-8 rounded-2xl shadow-lg">
                <div class="bg-purple-100 w-14 h-14 rounded-lg flex items-center justify-center mb-4">
                  <svg class="w-7 h-7 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"></path>
                  </svg>
                </div>
                <h3 class="text-xl font-bold mb-3">Pilnas paketas</h3>
                <p class="text-gray-600">
                  Gaukite visus dokumentus ir išsiųskite į ENA sistemą.
                </p>
              </div>
            </div>

            <div class="bg-gradient-to-r from-blue-600 to-green-600 rounded-2xl p-12 text-white text-center">
              <div class="grid md:grid-cols-3 gap-8">
                <div>
                  <div class="text-5xl font-bold mb-2">60%</div>
                  <div class="text-blue-100">Parama daugiabučiams</div>
                </div>
                <div>
                  <div class="text-5xl font-bold mb-2">5 min</div>
                  <div class="text-blue-100">Dokumentų generavimas</div>
                </div>
                <div>
                  <div class="text-5xl font-bold mb-2">100%</div>
                  <div class="text-blue-100">Atitiktis reikalavimams</div>
                </div>
              </div>
            </div>
          </div>

          <footer class="bg-gray-900 text-white py-8 mt-20">
            <div class="max-w-6xl mx-auto px-4 text-center">
              <p class="text-gray-400">© 2025 EV Docs LT. MVP versija. Sukurta su ❤️ Lietuvoje.</p>
            </div>
          </footer>
        </div>
      `;
    }

    function renderForm() {
      const currentStepData = steps[state.step];
      const isApartment = state.data.propertyType === 'apartment';
      const isTenant = state.data.ownership === 'tenant';
      
      let formFields = '';
      
      if (state.step === 0) {
        formFields = `
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Vardas ir Pavardė *</label>
            <input type="text" id="fullName" value="${state.data.fullName}" 
              onchange="updateData('fullName', this.value)" placeholder="Jonas Jonaitis"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${state.errors.fullName ? 'border-red-500' : 'border-gray-300'}">
            ${state.errors.fullName ? `<p class="text-red-500 text-sm mt-1">${state.errors.fullName}</p>` : ''}
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Asmens kodas *</label>
            <input type="text" id="personalCode" value="${state.data.personalCode}" maxlength="11"
              onchange="updateData('personalCode', this.value)" placeholder="39001010000"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${state.errors.personalCode ? 'border-red-500' : 'border-gray-300'}">
            ${state.errors.personalCode ? `<p class="text-red-500 text-sm mt-1">${state.errors.personalCode}</p>` : ''}
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Telefonas *</label>
            <input type="tel" id="phone" value="${state.data.phone}"
              onchange="updateData('phone', this.value)" placeholder="+370 600 00000"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${state.errors.phone ? 'border-red-500' : 'border-gray-300'}">
            ${state.errors.phone ? `<p class="text-red-500 text-sm mt-1">${state.errors.phone}</p>` : ''}
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">El. paštas *</label>
            <input type="email" id="email" value="${state.data.email}"
              onchange="updateData('email', this.value)" placeholder="jonas@example.lt"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${state.errors.email ? 'border-red-500' : 'border-gray-300'}">
            ${state.errors.email ? `<p class="text-red-500 text-sm mt-1">${state.errors.email}</p>` : ''}
          </div>
        `;
      } else if (state.step === 1) {
        formFields = `
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Pilnas adresas *</label>
            <input type="text" id="address" value="${state.data.address}"
              onchange="updateData('address', this.value)" placeholder="Gedimino pr. 1, Vilnius"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${state.errors.address ? 'border-red-500' : 'border-gray-300'}">
            ${state.errors.address ? `<p class="text-red-500 text-sm mt-1">${state.errors.address}</p>` : ''}
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Turto tipas *</label>
            <div class="grid grid-cols-2 gap-4">
              <button type="button" onclick="updateData('propertyType', 'apartment')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.propertyType === 'apartment' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                🏢 Daugiabutis
              </button>
              <button type="button" onclick="updateData('propertyType', 'house')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.propertyType === 'house' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                🏠 Individualus namas
              </button>
            </div>
            ${state.errors.propertyType ? `<p class="text-red-500 text-sm mt-1">${state.errors.propertyType}</p>` : ''}
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Nuosavybės statusas *</label>
            <div class="grid grid-cols-2 gap-4">
              <button type="button" onclick="updateData('ownership', 'owner')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.ownership === 'owner' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                Savininkas
              </button>
              <button type="button" onclick="updateData('ownership', 'tenant')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.ownership === 'tenant' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                Nuomininkas
              </button>
            </div>
            ${state.errors.ownership ? `<p class="text-red-500 text-sm mt-1">${state.errors.ownership}</p>` : ''}
          </div>
          ${isApartment ? `
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Buto numeris *</label>
            <input type="text" id="apartmentNumber" value="${state.data.apartmentNumber}"
              onchange="updateData('apartmentNumber', this.value)" placeholder="15"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${state.errors.apartmentNumber ? 'border-red-500' : 'border-gray-300'}">
            ${state.errors.apartmentNumber ? `<p class="text-red-500 text-sm mt-1">${state.errors.apartmentNumber}</p>` : ''}
          </div>
          ` : ''}
        `;
      } else if (state.step === 2) {
        formFields = `
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Parkavimo vietos vieta *</label>
            <div class="grid grid-cols-3 gap-4">
              <button type="button" onclick="updateData('parkingLocation', 'Požeminėje stovėjimo aikštelėje')"
                class="p-4 border-2 rounded-lg font-semibold text-sm transition-all ${state.data.parkingLocation === 'Požeminėje stovėjimo aikštelėje' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                Požeminė
              </button>
              <button type="button" onclick="updateData('parkingLocation', 'Kieme')"
                class="p-4 border-2 rounded-lg font-semibold text-sm transition-all ${state.data.parkingLocation === 'Kieme' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                Kieme
              </button>
              <button type="button" onclick="updateData('parkingLocation', 'Garaže')"
                class="p-4 border-2 rounded-lg font-semibold text-sm transition-all ${state.data.parkingLocation === 'Garaže' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                Garaže
              </button>
            </div>
            ${state.errors.parkingLocation ? `<p class="text-red-500 text-sm mt-1">${state.errors.parkingLocation}</p>` : ''}
          </div>
          ${isApartment ? `
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Parkavimo vietos numeris *</label>
            <input type="text" id="parkingSpot" value="${state.data.parkingSpot}"
              onchange="updateData('parkingSpot', this.value)" placeholder="12"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${state.errors.parkingSpot ? 'border-red-500' : 'border-gray-300'}">
            ${state.errors.parkingSpot ? `<p class="text-red-500 text-sm mt-1">${state.errors.parkingSpot}</p>` : ''}
          </div>
          ` : ''}
        `;
      } else if (state.step === 3) {
        formFields = `
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Stotelės tipas *</label>
            <div class="grid grid-cols-2 gap-4">
              <button type="button" onclick="updateData('chargerType', 'Sieninė')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.chargerType === 'Sieninė' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                🔌 Sieninė
              </button>
              <button type="button" onclick="updateData('chargerType', 'Ant žemės')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.chargerType === 'Ant žemės' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                ⚡ Ant žemės
              </button>
            </div>
            ${state.errors.chargerType ? `<p class="text-red-500 text-sm mt-1">${state.errors.chargerType}</p>` : ''}
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Stotelės galia *</label>
            <div class="grid grid-cols-3 gap-4">
              <button type="button" onclick="updateData('power', '7.4')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.power === '7.4' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                7.4 kW
              </button>
              <button type="button" onclick="updateData('power', '11')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.power === '11' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                11 kW
              </button>
              <button type="button" onclick="updateData('power', '22')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.power === '22' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                22 kW
              </button>
            </div>
            ${state.errors.power ? `<p class="text-red-500 text-sm mt-1">${state.errors.power}</p>` : ''}
            <p class="text-sm text-gray-500 mt-2">💡 Rekomenduojama 11 kW namų naudojimui</p>
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Prieigų skaičius *</label>
            <select onchange="updateData('connectors', this.value)" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
              <option value="1" ${state.data.connectors === '1' ? 'selected' : ''}>1 prieiga</option>
              <option value="2" ${state.data.connectors === '2' ? 'selected' : ''}>2 prieigos</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Stotelės modelis (neprivaloma)</label>
            <input type="text" id="chargerModel" value="${state.data.chargerModel || ''}"
              onchange="updateData('chargerModel', this.value)" placeholder="pvz. Tesla Wall Connector"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg">
          </div>
        `;
      } else if (state.step === 4) {
        if (isApartment) {
          formFields = `
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Ar jau turite bendrasavininkų sutikimą? *</label>
              <div class="grid grid-cols-2 gap-4">
                <button type="button" onclick="updateData('hasCoOwnerConsent', 'yes')"
                  class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.hasCoOwnerConsent === 'yes' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                  ✅ Taip, turiu
                </button>
                <button type="button" onclick="updateData('hasCoOwnerConsent', 'no')"
                  class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.hasCoOwnerConsent === 'no' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                  ❌ Ne, reikia šablono
                </button>
              </div>
              ${state.errors.hasCoOwnerConsent ? `<p class="text-red-500 text-sm mt-1">${state.errors.hasCoOwnerConsent}</p>` : ''}
              
              ${state.data.hasCoOwnerConsent === 'yes' ? `
                <div class="mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                  <h4 class="font-semibold text-blue-900 mb-2">📄 Įkelkite bendrasavininkų sutikimą</h4>
                  <p class="text-sm text-blue-800 mb-3">Reikalingas dokumentas: Susirinkimo protokolas arba rašytiniai sutikimai (CK 4.75 str.)</p>
                  ${!state.files.coOwnerConsent ? `
                    <input type="file" id="coOwnerConsent" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileUpload('coOwnerConsent', this)" class="w-full">
                  ` : `
                    <div class="bg-white p-2 rounded flex justify-between items-center">
                      <span class="text-sm">${state.files.coOwnerConsent.name}</span>
                      <button onclick="removeFile('coOwnerConsent')" class="text-red-600">✕</button>
                    </div>
                  `}
                </div>
              ` : ''}
              
              ${state.data.hasCoOwnerConsent === 'no' ? `
                <div class="mt-4 p-4 bg-green-50 border border-green-200 rounded-lg">
                  <h4 class="font-semibold text-green-900 mb-1">✓ Sugeneruosime šablonus</h4>
                  <p class="text-sm text-green-800">Gausite 2 dokumentus: (1) Bendrasavininkų sutikimo formą, (2) Susirinkimo protokolo šabloną.</p>
                </div>
              ` : ''}
            </div>
          `;
        } else {
          formFields = `
            <div class="p-4 bg-green-50 border border-green-200 rounded-lg">
              <h4 class="font-semibold text-green-900 mb-1">✓ Gražusu!</h4>
              <p class="text-sm text-green-800">Individualiems namams nereikia bendrasavininkų sutikimo. Spausti "Generuoti dokumentus"!</p>
            </div>
          `;
        }
      }

      return `
        <div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50">
          <div class="bg-white border-b border-gray-200">
            <div class="max-w-4xl mx-auto px-4 py-4">
              <div class="flex items-center justify-between mb-4">
                <button onclick="changePage('landing')" class="flex items-center gap-2 text-gray-600 hover:text-gray-900">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                  </svg>
                  Grįžti
                </button>
                <div class="flex items-center gap-2">
                  <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                  </svg>
                  <span class="font-bold text-gray-900">EV Docs LT</span>
                </div>
              </div>
              
              <div class="flex items-center gap-2 mb-2">
                ${steps.map((_, idx) => `
                  <div class="flex-1">
                    <div class="h-2 rounded-full transition-all ${idx <= state.step ? 'bg-blue-600' : 'bg-gray-200'}"></div>
                  </div>
                  ${idx < steps.length - 1 ? `
                    <svg class="w-5 h-5 ${idx < state.step ? 'text-blue-600' : 'text-gray-300'}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path>
                    </svg>
                  ` : ''}
                `).join('')}
              </div>
              <div class="text-sm text-gray-600 text-center">
                Žingsnis ${state.step + 1} iš ${steps.length}: ${currentStepData.title}
              </div>
            </div>
          </div>

          <div class="max-w-2xl mx-auto px-4 py-12">
            <div class="bg-white rounded-2xl shadow-lg p-8">
              <h2 class="text-2xl font-bold mb-6">${currentStepData.title}</h2>
              
              <div class="space-y-6">
                ${formFields}
              </div>

              <div class="flex gap-4 mt-8">
                ${state.step > 0 ? `
                  <button onclick="prevStep()" class="flex-1 bg-gray-100 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-200 transition-all">
                    ← Atgal
                  </button>
                ` : ''}
                
                <button onclick="nextStep()" class="flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-all">
                  ${state.step === steps.length - 1 ? 'Generuoti dokumentus' : 'Toliau'} →
                </button>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function renderResult() {
      const isApartment = state.data.propertyType === 'apartment';
      const isTenant = state.data.ownership === 'tenant';
      const needsCoOwnerDocs = isApartment && state.data.hasCoOwnerConsent === 'no';
      const hasCoOwnerDocs = isApartment && state.data.hasCoOwnerConsent === 'yes';

      return `
        <div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50">
          <nav class="bg-white border-b border-gray-200">
            <div class="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
              <div class="flex items-center gap-2">
                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                </svg>
                <span class="font-bold text-gray-900">EV Docs LT</span>
              </div>
              <button onclick="resetForm()" class="text-gray-600 hover:text-gray-900">Naujas projektas</button>
            </div>
          </nav>

          <div class="max-w-4xl mx-auto px-4 py-12">
            <div class="text-center mb-8">
              <div class="inline-flex items-center justify-center w-20 h-20 bg-green-100 rounded-full mb-4">
                <svg class="w-10 h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path>
                </svg>
              </div>
              <h1 class="text-4xl font-bold mb-3">Dokumentai sugeneruoti!</h1>
              <p class="text-xl text-gray-600">Sveikiname, ${state.data.fullName}! Jūsų dokumentai paruošti.</p>
            </div>

            <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
              <h2 class="text-2xl font-bold mb-6">📦 Sugeneruoti dokumentai</h2>
              
              <div class="space-y-4 mb-8">
                <div class="flex items-center gap-4 p-4 bg-gray-50 rounded-lg">
                  <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"></path>
                  </svg>
                  <div class="flex-1">
                    <h3 class="font-semibold">Pareiškimas</h3>
                    <p class="text-sm text-gray-600">${isApartment ? 'Prašymas bendrasavininkams' : 'Informavimas apie įrengimą'}</p>
                  </div>
                  <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path>
                  </svg>
                </div>
                
                ${needsCoOwnerDocs ? `
                  <div class="flex items-center gap-4 p-4 bg-gray-50 rounded-lg">
                    <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"></path>
                    </svg>
                    <div class="flex-1">
                      <h3 class="font-semibold">Bendrasavininkų sutikimo forma</h3>
                      <p class="text-sm text-gray-600">Parašų rinkimo lentelė</p>
                    </div>
                    <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path>
                    </svg>
                  </div>
                ` : ''}
              </div>

              <button onclick="downloadDocuments(event)" class="w-full bg-blue-600 text-white px-8 py-4 rounded-lg font-semibold text-lg hover:bg-blue-700 transition-all shadow-lg">
                ⬇️ Atsisiųsti dokumentus (PDF)
              </button>
            </div>

            <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
              <h2 class="text-2xl font-bold mb-6">📤 Įkelkite kitus dokumentus</h2>
              <p class="text-gray-600 mb-6">Įkelkite visus reikalingus dokumentus. Žemiau rasite instrukcijas, kaip juos gauti.</p>
              
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">1. NT registro išrašas *</label>
                  ${!state.files.propertyDeed ? `
                    <div class="mb-2 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                      <p class="text-xs text-blue-900 font-semibold mb-1">📍 Kaip gauti:</p>
                      <p class="text-xs text-blue-800">• Internetu: <a href="https://www.registrucentras.lt/paslaugos" target="_blank" class="underline">www.registrucentras.lt/paslaugos</a></p>
                      <p class="text-xs text-blue-800">• Kaina: 2-3 EUR | Trukmė: Iš karto</p>
                      <p class="text-xs text-blue-800">• Reikia prisijungti per el. valdžios vartus</p>
                    </div>
                    <input type="file" id="propertyDeed" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileUpload('propertyDeed', this)" 
                      class="w-full p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 cursor-pointer">
                  ` : `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-3 flex items-center justify-between">
                      <span class="text-sm font-semibold">✓ ${state.files.propertyDeed.name}</span>
                      <button onclick="removeFile('propertyDeed')" class="text-red-600 hover:text-red-800">✕</button>
                    </div>
                  `}
                </div>

                ${hasCoOwnerDocs ? `
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">2. Bendrasavininkų sutikimas *</label>
                  ${!state.files.coOwnerConsent ? `
                    <div class="mb-2 p-3 bg-purple-50 border border-purple-200 rounded-lg">
                      <p class="text-xs text-purple-900 font-semibold mb-1">📋 Jūsų turimas dokumentas:</p>
                      <p class="text-xs text-purple-800">• Susirinkimo protokolas ARBA</p>
                      <p class="text-xs text-purple-800">• Visų bendrasavininkų rašytiniai sutikimai</p>
                      <p class="text-xs text-purple-800 mt-1">• Turi atitikti CK 4.75, 4.85 str.</p>
                    </div>
                    <input type="file" id="coOwnerConsent2" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileUpload('coOwnerConsent', this)" 
                      class="w-full p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 cursor-pointer">
                  ` : `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-3 flex items-center justify-between">
                      <span class="text-sm font-semibold">✓ ${state.files.coOwnerConsent.name}</span>
                      <button onclick="removeFile('coOwnerConsent')" class="text-red-600 hover:text-red-800">✕</button>
                    </div>
                  `}
                </div>
                ` : ''}

                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">${hasCoOwnerDocs ? '3' : '2'}. ESO prijungimo sąlygos *</label>
                  ${!state.files.esoConditions ? `
                    <div class="mb-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                      <p class="text-xs text-yellow-900 font-semibold mb-1">⚡ Kaip gauti:</p>
                      <p class="text-xs text-yellow-800">• Internetu: <a href="https://www.eso.lt" target="_blank" class="underline">www.eso.lt</a> → Paslaugos → Naujo objekto prijungimas</p>
                      <p class="text-xs text-yellow-800">• Tel.: 1852 (darbo dienomis 8-17 val.)</p>
                      <p class="text-xs text-yellow-800">• Trukmė: 5-10 d.d. | Kaina: Nemokama</p>
                      <p class="text-xs text-yellow-800 mt-1">• Reikalingi dok.: Pareiškimas, NT išrašas, EV specifikacija</p>
                    </div>
                    <input type="file" id="esoConditions" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileUpload('esoConditions', this)" 
                      class="w-full p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 cursor-pointer">
                  ` : `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-3 flex items-center justify-between">
                      <span class="text-sm font-semibold">✓ ${state.files.esoConditions.name}</span>
                      <button onclick="removeFile('esoConditions')" class="text-red-600 hover:text-red-800">✕</button>
                    </div>
                  `}
                </div>

                ${isTenant ? `
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">${hasCoOwnerDocs ? '4' : '3'}. Nuomotojo sutikimas *</label>
                  ${!state.files.landlordConsent ? `
                    <div class="mb-2 p-3 bg-orange-50 border border-orange-200 rounded-lg">
                      <p class="text-xs text-orange-900 font-semibold mb-1">📝 Kas reikalinga:</p>
                      <p class="text-xs text-orange-800">• Rašytinis nuomotojo sutikimas įrengti stotelę</p>
                      <p class="text-xs text-orange-800">• Nuomos sutarties kopija</p>
                      <p class="text-xs text-orange-800 mt-1">• Svarbu: Nuomos sutartis turi galioti ne trumpiau nei 4 metai!</p>
                    </div>
                    <input type="file" id="landlordConsent" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileUpload('landlordConsent', this)" 
                      class="w-full p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 cursor-pointer">
                  ` : `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-3 flex items-center justify-between">
                      <span class="text-sm font-semibold">✓ ${state.files.landlordConsent.name}</span>
                      <button onclick="removeFile('landlordConsent')" class="text-red-600 hover:text-red-800">✕</button>
                    </div>
                  `}
                </div>
                ` : ''}
              </div>

              ${allDocsUploaded() ? `
                <div class="mt-8">
                  <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                    <h3 class="font-bold text-green-900 mb-2">✓ Visi dokumentai įkelti!</h3>
                    <p class="text-sm text-green-800">Galite išsiųsti dokumentus tiesiai į ENA sistemą.</p>
                  </div>

                  <div class="flex gap-4">
                    <button onclick="downloadDocuments(event)" class="flex-1 bg-blue-600 text-white px-6 py-4 rounded-lg font-semibold hover:bg-blue-700 transition-all">
                      ⬇️ Atsisiųsti PDF
                    </button>
                    <button onclick="sendToInstitutions(event)" class="flex-1 bg-green-600 text-white px-6 py-4 rounded-lg font-semibold hover:bg-green-700 transition-all">
                      📧 Siųsti į ENA
                    </button>
                  </div>
                </div>
              ` : `
                <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                  <p class="text-sm text-blue-800"><strong>Liko įkelti:</strong> 
                    ${!state.files.propertyDeed ? 'NT išrašas' : ''}
                    ${!state.files.propertyDeed && !state.files.esoConditions ? ', ' : ''}
                    ${!state.files.esoConditions ? 'ESO sąlygos' : ''}
                    ${hasCoOwnerDocs && !state.files.coOwnerConsent ? ', Sutikimas' : ''}
                    ${isTenant && !state.files.landlordConsent ? ', Nuomotojo sutikimas' : ''}
                  </p>
                </div>
              `}
            </div>

            <div class="bg-gradient-to-r from-blue-600 to-green-600 rounded-2xl p-8 text-white">
              <h2 class="text-2xl font-bold mb-6">🎯 Pilnas proceso aprašymas</h2>
              <div class="space-y-4">
                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-start gap-3">
                    <div class="bg-white text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">1</div>
                    <div>
                      <p class="font-bold text-lg mb-1">Atsisiųskite sugeneruotus dokumentus</p>
                      <p class="text-sm text-blue-50">📄 PDF faile rasite: Pareiškimą${needsCoOwnerDocs ? ', Bendrasavininkų sutikimo šabloną' : ''} ir visas instrukcijas</p>
                      <p class="text-sm text-blue-50 mt-1">✓ Saugokite failus savo kompiuteryje</p>
                    </div>
                  </div>
                </div>

                ${needsCoOwnerDocs ? `
                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-start gap-3">
                    <div class="bg-white text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">2</div>
                    <div>
                      <p class="font-bold text-lg mb-1">Surinkite bendrasavininkų parašus</p>
                      <p class="text-sm text-blue-50">📋 Naudokite PDF šabloną arba sušaukite susirinkimą</p>
                      <p class="text-sm text-blue-50">⏱️ Trukmė: 1-4 savaitės (priklauso nuo bendrasavininkų aktyvumo)</p>
                      <p class="text-sm text-blue-50 mt-1">💡 Patarimas: Siūlykite bendrą susirinkimą - greičiau!</p>
                    </div>
                  </div>
                </div>
                ` : ''}

                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-start gap-3">
                    <div class="bg-white text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">${needsCoOwnerDocs ? '3' : '2'}</div>
                    <div>
                      <p class="font-bold text-lg mb-1">Gaukite NT registro išrašą</p>
                      <p class="text-sm text-blue-50">🌐 <a href="https://www.registrucentras.lt/paslaugos" target="_blank" class="underline">www.registrucentras.lt/paslaugos</a></p>
                      <p class="text-sm text-blue-50">💶 Kaina: 2-3 EUR | ⏱️ Trukmė: Iš karto (el. formatu)</p>
                      <p class="text-sm text-blue-50 mt-1">🔑 Reikia prisijungti per el. valdžios vartus</p>
                    </div>
                  </div>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-start gap-3">
                    <div class="bg-white text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">${needsCoOwnerDocs ? '4' : '3'}</div>
                    <div>
                      <p class="font-bold text-lg mb-1">Kreipkitės į ESO dėl prijungimo sąlygų</p>
                      <p class="text-sm text-blue-50">🌐 <a href="https://www.eso.lt" target="_blank" class="underline">www.eso.lt</a> → Paslaugos → Naujo objekto prijungimas</p>
                      <p class="text-sm text-blue-50">📞 Tel.: 1852 | ⏱️ Trukmė: 5-10 d.d. | 💶 Nemokama</p>
                      <p class="text-sm text-blue-50 mt-1">📋 Reikės: Pareiškimo, NT išrašo, EV stotelės specifikacijos</p>
                    </div>
                  </div>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-start gap-3">
                    <div class="bg-white text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">${needsCoOwnerDocs ? '5' : '4'}</div>
                    <div>
                      <p class="font-bold text-lg mb-1">Pasirinkite rangovą su VERT atestu</p>
                      <p class="text-sm text-blue-50">🔧 Pavyzdžiai: Charge In (+370 612 77700), Solet Technics (+370 614 51775)</p>
                      <p class="text-sm text-blue-50">🌐 Daugiau: <a href="https://www.vert.lt" target="_blank" class="underline">www.vert.lt</a> (atestuotų elektrikų sąrašas)</p>
                      <p class="text-sm text-blue-50 mt-1">💡 Gaukite bent 2-3 pasiūlymus - palyginkite kainas!</p>
                    </div>
                  </div>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-start gap-3">
                    <div class="bg-white text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">${needsCoOwnerDocs ? '6' : '5'}</div>
                    <div>
                      <p class="font-bold text-lg mb-1">Pateikite paraišką ENA paramai (PRIEŠ įrengimą!)</p>
                      <p class="text-sm text-blue-50">🌐 <a href="https://www.ena.lt" target="_blank" class="underline">www.ena.lt</a> → Parama → EV stotelės</p>
                      <p class="text-sm text-blue-50">⏱️ Laukimo laikas: 5-10 d.d.</p>
                      <p class="text-sm text-blue-50 mt-1">⚠️ SVARBU: Paraišką BŪTINA pateikti PRIEŠ įrengimą!</p>
                    </div>
                  </div>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-start gap-3">
                    <div class="bg-white text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">${needsCoOwnerDocs ? '7' : '6'}</div>
                    <div>
                      <p class="font-bold text-lg mb-1">Įrenkite stotelę ir pateikite dokumentus paramai</p>
                      <p class="text-sm text-blue-50">Po įrengimo pateikite ENA: PVM sąskaitą, perdavimo aktą, bandymo protokolus</p>
                      <p class="text-sm text-blue-50 mt-2">💰 <span class="text-yellow-300 font-bold">Gausite: ${isApartment ? '60%' : '40%'} kompensaciją (maks. 1,500 EUR)</span></p>
                      <p class="text-sm text-blue-50">⏱️ Paramos išmokėjimas: 1-2 mėnesiai po dokumentų pateikimo</p>
                    </div>
                  </div>
                </div>

                <div class="mt-4 bg-yellow-400/20 border-2 border-yellow-300 rounded-lg p-4">
                  <p class="font-bold text-lg mb-2">⚠️ SVARBU - Paramos programa</p>
                  <p class="text-sm text-blue-50">• Programa galioja iki 2025 m. rugsėjo mėn. (tikslinkite ENA!)</p>
                  <p class="text-sm text-blue-50">• Parama skiriama tik jei paraiška pateikta PRIEŠ įrengimą</p>
                  <p class="text-sm text-blue-50">• Lėšos ribotos - verta skubėti!</p>
                </div>
              </div>
            </div>
            <div class="mt-8 bg-white rounded-2xl shadow-lg p-8">
              <h2 class="text-2xl font-bold mb-6">📞 Naudingi kontaktai</h2>
              <div class="grid md:grid-cols-2 gap-6">
                <div class="border border-gray-200 rounded-lg p-4">
                  <h3 class="font-bold text-lg mb-2 text-blue-600">🏛️ Energetikos agentūra (ENA)</h3>
                  <p class="text-sm text-gray-600 mb-2">Paramos administravimas</p>
                  <p class="text-sm">🌐 <a href="https://www.ena.lt" target="_blank" class="text-blue-600 underline">www.ena.lt</a></p>
                  <p class="text-sm">📧 info@ena.lt</p>
                  <p class="text-sm">📞 +370 5 263 9823</p>
                </div>

                <div class="border border-gray-200 rounded-lg p-4">
                  <h3 class="font-bold text-lg mb-2 text-yellow-600">⚡ ESO (Elektros tinklai)</h3>
                  <p class="text-sm text-gray-600 mb-2">Prijungimo sąlygos</p>
                  <p class="text-sm">🌐 <a href="https://www.eso.lt" target="_blank" class="text-blue-600 underline">www.eso.lt</a></p>
                  <p class="text-sm">📞 1852 (darbo d. 8-17 val.)</p>
                  <p class="text-sm">📧 info@eso.lt</p>
                </div>

                <div class="border border-gray-200 rounded-lg p-4">
                  <h3 class="font-bold text-lg mb-2 text-green-600">📋 Registrų centras</h3>
                  <p class="text-sm text-gray-600 mb-2">NT registro išrašai</p>
                  <p class="text-sm">🌐 <a href="https://www.registrucentras.lt" target="_blank" class="text-blue-600 underline">www.registrucentras.lt</a></p>
                  <p class="text-sm">📞 1884 (darbo d. 8-17 val.)</p>
                  <p class="text-sm">📧 info@registrucentras.lt</p>
                </div>

                <div class="border border-gray-200 rounded-lg p-4">
                  <h3 class="font-bold text-lg mb-2 text-purple-600">🔧 VERT (Elektros įrenginiai)</h3>
                  <p class="text-sm text-gray-600 mb-2">Atestuoti rangovai</p>
                  <p class="text-sm">🌐 <a href="https://www.vert.lt" target="_blank" class="text-blue-600 underline">www.vert.lt</a></p>
                  <p class="text-sm">📞 +370 5 213 1165</p>
                  <p class="text-sm">📧 info@vert.lt</p>
                </div>
              </div>

              <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                <h3 class="font-bold mb-2">🛠️ Rekomenduojami rangovai:</h3>
                <div class="grid md:grid-cols-3 gap-4 text-sm">
                  <div>
                    <p class="font-semibold">Charge In</p>
                    <p class="text-gray-600">📞 +370 612 77700</p>
                    <p class="text-gray-600">🌐 <a href="https://www.chargein.lt" target="_blank" class="text-blue-600 underline">chargein.lt</a></p>
                  </div>
                  <div>
                    <p class="font-semibold">Solet Technics</p>
                    <p class="text-gray-600">📞 +370 614 51775</p>
                    <p class="text-gray-600">🌐 <a href="https://www.solet.lt" target="_blank" class="text-blue-600 underline">solet.lt</a></p>
                  </div>
                  <div>
                    <p class="font-semibold">Elektrum</p>
                    <p class="text-gray-600">📞 +370 700 32200</p>
                    <p class="text-gray-600">🌐 <a href="https://www.elektrum.lt" target="_blank" class="text-blue-600 underline">elektrum.lt</a></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    // Event handlers
    function changePage(page) {
      state.page = page;
      render();
    }

    function updateData(field, value) {
      state.data[field] = value;
      if (state.errors[field]) {
        delete state.errors[field];
      }
      render();
    }

    function nextStep() {
      if (validateStep()) {
        if (state.step < steps.length - 1) {
          state.step++;
          render();
        } else {
          state.page = 'result';
          render();
        }
      } else {
        render();
      }
    }

    function prevStep() {
      if (state.step > 0) {
        state.step--;
        render();
      }
    }

    function handleFileUpload(fileType, input) {
      const file = input.files[0];
      if (file) {
        if (file.size > 10 * 1024 * 1024) {
          alert('Failas per didelis! Maksimalus dydis: 10MB');
          input.value = '';
          return;
        }
        state.files[fileType] = file;
        render();
      }
    }

    function removeFile(fileType) {
      state.files[fileType] = null;
      render();
    }

    function resetForm() {
      state = {
        page: 'landing',
        step: 0,
        errors: {},
        files: { propertyDeed: null, coOwnerConsent: null, esoConditions: null, landlordConsent: null },
        data: {
          fullName: '', personalCode: '', phone: '', email: '', address: '', apartmentNumber: '',
          propertyType: '', ownership: '', parkingSpot: '', parkingLocation: '', chargerType: '',
          power: '', connectors: '1', chargerModel: '', hasCoOwnerConsent: ''
        }
      };
      render();
    }

    // Main render
    function render() {
      const app = document.getElementById('app');
      if (state.page === 'landing') {
        app.innerHTML = renderLanding();
      } else if (state.page === 'form') {
        app.innerHTML = renderForm();
      } else if (state.page === 'result') {
        app.innerHTML = renderResult();
      }
    }

    // Initial render
    render();
  </script>
</body>
</html>

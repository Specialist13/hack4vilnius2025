<!DOCTYPE html>
<html lang="lt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EV Docs LT - ElektromobiliÅ³ krovimo stotelÄ—s dokumentai</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
    body { font-family: 'Inter', sans-serif; }
  </style>
</head>
<body class="bg-gray-50">
  <div id="app"></div>

  <script>
    // State management
    let state = {
      page: 'landing', // 'landing', 'form', 'result'
      step: 0,
      errors: {},
      files: {
        propertyDeed: null,
        coOwnerConsent: null,
        esoConditions: null,
        landlordConsent: null
      },
      data: {
        fullName: '',
        personalCode: '',
        phone: '',
        email: '',
        address: '',
        apartmentNumber: '',
        propertyType: '',
        ownership: '',
        parkingSpot: '',
        parkingLocation: '',
        chargerType: '',
        power: '',
        connectors: '1',
        chargerModel: '',
        hasCoOwnerConsent: ''
      }
    };

    const steps = [
      { title: 'AsmeninÄ— informacija', fields: ['fullName', 'personalCode', 'phone', 'email'] },
      { title: 'Turto informacija', fields: ['address', 'propertyType', 'ownership', 'apartmentNumber'] },
      { title: 'Parkavimo vieta', fields: ['parkingLocation', 'parkingSpot'] },
      { title: 'StotelÄ—s parametrai', fields: ['chargerType', 'power', 'connectors'] },
      { title: 'Dokumentai', fields: ['hasCoOwnerConsent'] }
    ];

    function validateStep() {
      const currentFields = steps[state.step].fields;
      const newErrors = {};
      
      currentFields.forEach(field => {
        if (field === 'apartmentNumber' && state.data.propertyType !== 'apartment') return;
        if (field === 'parkingSpot' && state.data.propertyType !== 'apartment') return;
        if (field === 'hasCoOwnerConsent' && state.data.propertyType !== 'apartment') return;
        
        if (!state.data[field] || state.data[field].trim() === '') {
          newErrors[field] = 'Å is laukas yra privalomas';
        }
      });
      
      if (state.step === 0) {
        if (state.data.personalCode && !/^\d{11}$/.test(state.data.personalCode)) {
          newErrors.personalCode = 'Asmens kodas turi bÅ«ti 11 skaitmenÅ³';
        }
        if (state.data.phone && !/^\+?370\s?\d{8}$/.test(state.data.phone.replace(/\s/g, ''))) {
          newErrors.phone = 'Neteisingas telefono formatas (+370 XXXXXXXX)';
        }
        if (state.data.email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(state.data.email)) {
          newErrors.email = 'Neteisingas el. paÅ¡to formatas';
        }
      }
      
      state.errors = newErrors;
      return Object.keys(newErrors).length === 0;
    }

    function generateDocument() {
      const d = state.data;
      const isApartment = d.propertyType === 'apartment';
      const needsCoOwnerDocs = isApartment && d.hasCoOwnerConsent === 'no';
      
      return `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    EV DOCS LT - SUGENERUOTI DOKUMENTAI
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DOKUMENTAS #1: PAREIÅ KIMAS DÄ–L EV Ä®KROVIMO STOTELÄ–S Ä®RENGIMO

${new Date().toLocaleDateString('lt-LT')}

${isApartment ? `DaugiabuÄio namo ${d.address}
ButÅ³ ir kitÅ³ patalpÅ³ savininkams` : `PareiÅ¡kimas dÄ—l elektromobilio Ä¯krovimo stotelÄ—s Ä¯rengimo
${d.address}`}

PareiÅ¡kÄ—jas: ${d.fullName}
Gyvenamoji vieta: ${d.address}
Asmens kodas: ${d.personalCode}
Tel.: ${d.phone}
El. paÅ¡tas: ${d.email}

${isApartment ? 'PRAÅ AU LEISTI Ä®RENGTI ELEKTROMOBILIO Ä®KROVIMO STOTELÄ˜' : 'PAREIÅ KIMAS DÄ–L EV STOTELÄ–S Ä®RENGIMO'}

1. AÅ¡, ${d.fullName}, esu ${isApartment ? `buto Nr. ${d.apartmentNumber}` : 'namo'} 
   ${d.ownership === 'owner' ? 'savininkas(-Ä—)' : 'nuomininkas(-Ä—)'} adresu ${d.address}.

2. ${isApartment ? 'PraÅ¡au JÅ«sÅ³ sutikimo Ä¯rengti' : 'Informuoju apie ketinimÄ… Ä¯rengti'} elektromobilio Ä¯krovimo stotelÄ™ 
   ${isApartment ? `man priklausanÄioje parkavimo vietoje Nr. ${d.parkingSpot}` : 'savo teritorijoje'}, 
   esanÄioje ${d.parkingLocation}.

3. Ä®rengiamos stotelÄ—s parametrai:
   - Tipas: ${d.chargerType}
   - Galia: ${d.power} kW
   - PrieigÅ³ skaiÄius: ${d.connectors}
   - Gamintojo modelis: ${d.chargerModel || 'bus nurodyta vÄ—liau'}

Ä®sipareigoju laikytis visÅ³ teisÄ—s aktÅ³ reikalavimÅ³ ir uÅ¾tikrinti saugÅ³ eksploatavimÄ….

PareiÅ¡kÄ—jas: _________________ (${d.fullName})

${new Date().toLocaleDateString('lt-LT')}

${needsCoOwnerDocs ? `
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DOKUMENTAS #2: BENDRASAVININKÅ² SUTIKIMO Å ABLONAS

DaugiabuÄio namo ${d.address}

BENDRASAVININKÅ² SUTIKIMAS
DÄ–L ELEKTROMOBILIO Ä®KROVIMO STOTELÄ–S Ä®RENGIMO

Mes, Å¾emiau pasiraÅ¡Ä™ butÅ³ savininkai, SUTINKAME, 
kad ${d.fullName}, buto Nr. ${d.apartmentNumber} 
savininkas(-Ä—), Ä¯rengtÅ³ elektromobilio Ä¯krovimo stotelÄ™ 
parkavimo vietoje Nr. ${d.parkingSpot}.

BendrasavininkÅ³ sÄ…raÅ¡as:

Nr. | Buto Nr. | Savininkas | Asmens kodas | ParaÅ¡as | Data
----|----------|------------|--------------|---------|------
1.  |          |            |              |         |
2.  |          |            |              |         |
3.  |          |            |              |         |
` : ''}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TOLIMESNI Å½INGSNIAI:

${needsCoOwnerDocs ? '1. âœ“ Surinkti bendrasavininkÅ³ paraÅ¡us' : '1. âœ“ ParuoÅ¡ti sutikimus'}
2. â˜ Gauti NT registro iÅ¡raÅ¡Ä… (www.registrucentras.lt)
3. â˜ Kreiptis Ä¯ ESO dÄ—l prijungimo sÄ…lygÅ³ (www.eso.lt, tel. 1852)
4. â˜ Pateikti paraiÅ¡kÄ… ENA (www.ena.lt)

PARAMA: ${isApartment ? '60%' : '40%'} Ä¯rengimo iÅ¡laidÅ³ (maks. 1,500 EUR)

Sugeneruota: ${new Date().toLocaleString('lt-LT')}
Sistema: EV Docs LT v1.0 MVP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•`;
    }

    function downloadDocuments(event) {
      if (event) event.preventDefault();
      
      const d = state.data;
      const isApartment = d.propertyType === 'apartment';
      const needsCoOwnerDocs = isApartment && d.hasCoOwnerConsent === 'no';
      const hasCoOwnerDocs = d.hasCoOwnerConsent === 'yes';
      
      // Create HTML content with proper Lithuanian character support
      const htmlContent = `
        <div style="font-family: Arial, sans-serif; padding: 20px; font-size: 11px; line-height: 1.5;">
          <!-- Header -->
          <div style="background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); color: white; padding: 20px; text-align: center; margin: -20px -20px 20px -20px;">
            <h1 style="margin: 0; font-size: 24px; font-weight: bold;">EV DOCS LT</h1>
            <p style="margin: 5px 0 0 0; font-size: 14px;">ElektromobiliÅ³ krovimo stotelÄ—s dokumentai</p>
            <p style="margin: 5px 0 0 0; font-size: 10px;">${new Date().toLocaleDateString('lt-LT')}</p>
          </div>
          
          <!-- Document 1: PareiÅ¡kimas -->
          <div style="background: #f3f4f6; padding: 8px; margin: 20px 0 10px 0;">
            <h2 style="margin: 0; font-size: 16px; font-weight: bold;">DOKUMENTAS #1: PAREIÅ KIMAS</h2>
          </div>
          
          <h3 style="text-align: center; font-size: 13px; margin: 15px 0;">DÄ—l elektromobilio Ä¯krovimo stotelÄ—s Ä¯rengimo</h3>
          
          ${isApartment ? `
            <p><strong>DaugiabuÄio namo ${d.address}</strong></p>
            <p>ButÅ³ ir kitÅ³ patalpÅ³ savininkams</p>
          ` : `
            <p><strong>Adresas:</strong> ${d.address}</p>
          `}
          
          <h4 style="margin-top: 20px; font-size: 12px; font-weight: bold;">PAREIÅ KÄ–JO DUOMENYS:</h4>
          <p><strong>Vardas, pavardÄ—:</strong> ${d.fullName}</p>
          <p><strong>Asmens kodas:</strong> ${d.personalCode}</p>
          <p><strong>Adresas:</strong> ${d.address}</p>
          ${isApartment ? `<p><strong>Buto numeris:</strong> ${d.apartmentNumber}</p>` : ''}
          <p><strong>Telefonas:</strong> ${d.phone}</p>
          <p><strong>El. paÅ¡tas:</strong> ${d.email}</p>
          
          <h4 style="margin-top: 20px; font-size: 12px; font-weight: bold;">
            ${isApartment ? 'PRAÅ AU LEISTI Ä®RENGTI:' : 'INFORMUOJU APIE KETINIMÄ„ Ä®RENGTI:'}
          </h4>
          <p>Elektromobilio Ä¯krovimo stotelÄ™ ${isApartment ? 'parkavimo vietoje Nr. ' + d.parkingSpot : 'savo teritorijoje'}, esanÄioje ${d.parkingLocation}.</p>
          
          <h4 style="margin-top: 20px; font-size: 12px; font-weight: bold;">STOTELÄ–S PARAMETRAI:</h4>
          <ul style="margin: 5px 0; padding-left: 20px;">
            <li>Tipas: ${d.chargerType}</li>
            <li>Galia: ${d.power} kW</li>
            <li>PrieigÅ³ skaiÄius: ${d.connectors}</li>
            ${d.chargerModel ? `<li>Modelis: ${d.chargerModel}</li>` : ''}
          </ul>
          
          <h4 style="margin-top: 20px; font-size: 12px; font-weight: bold;">Ä®SIPAREIGOJIMAI:</h4>
          <ul style="margin: 5px 0; padding-left: 20px;">
            <li>Laikytis visÅ³ Lietuvos Respublikos statybos ir elektros saugos reikalavimÅ³</li>
            <li>Naudoti tik sertifikuotÄ… ir naujÄ… Ä¯rangÄ…</li>
            <li>Ä®rengimo darbus pavesti atestuotam rangovui su VERT atestu</li>
            <li>Tinkamai eksploatuoti ir priÅ¾iÅ«rÄ—ti Ä¯rengtÄ… stotelÄ™</li>
            ${isApartment ? '<li>Kompensuoti Å¾alÄ… bendriesiems objektams, jei tokia atsiras</li>' : ''}
          </ul>
          
          <div style="margin-top: 40px;">
            <p>PareiÅ¡kÄ—jas: ___________________________</p>
            <p style="margin-left: 80px;">(${d.fullName})</p>
            <p>Data: ${new Date().toLocaleDateString('lt-LT')}</p>
          </div>
          
          ${needsCoOwnerDocs ? `
            <div style="page-break-before: always; padding-top: 20px;">
              <div style="background: #f3f4f6; padding: 8px; margin: 0 0 10px 0;">
                <h2 style="margin: 0; font-size: 16px; font-weight: bold;">DOKUMENTAS #2: BENDRASAVININKÅ² SUTIKIMAS</h2>
              </div>
              
              <h3 style="text-align: center; font-size: 13px; margin: 15px 0;">
                DaugiabuÄio namo ${d.address}<br/>
                BENDRASAVININKÅ² SUTIKIMAS<br/>
                DÄ–L EV Ä®KROVIMO STOTELÄ–S Ä®RENGIMO
              </h3>
              
              <p>Mes, Å¾emiau pasiraÅ¡Ä™ daugiabuÄio namo butÅ³ ir kitÅ³ patalpÅ³ savininkai, <strong>SUTINKAME</strong>, kad ${d.fullName}, buto Nr. ${d.apartmentNumber} savininkas(-Ä—), Ä¯rengtÅ³ elektromobilio Ä¯krovimo stotelÄ™ parkavimo vietoje Nr. ${d.parkingSpot}.</p>
              
              <h4 style="margin-top: 20px; font-size: 12px; font-weight: bold;">STOTELÄ–S PARAMETRAI:</h4>
              <ul style="margin: 5px 0; padding-left: 20px;">
                <li>Galia: ${d.power} kW</li>
                <li>Tipas: ${d.chargerType}</li>
                <li>PrieigÅ³ skaiÄius: ${d.connectors}</li>
              </ul>
              
              <h4 style="margin-top: 20px; font-size: 12px; font-weight: bold;">SÄ„LYGOS:</h4>
              <ol style="margin: 5px 0; padding-left: 20px;">
                <li>StotelÄ— bus Ä¯rengta pagal LR statybos ir elektros Ä¯renginiÅ³ reikalavimus</li>
                <li>Bus naudojama tik sertifikuota ir nauja Ä¯ranga</li>
                <li>Darbai bus atliekami atestuoto rangovo su VERT atestu</li>
                <li>Bus gautos ir Ä¯vykdytos ESO prijungimo sÄ…lygos</li>
                <li>PareiÅ¡kÄ—jas Ä¯sipareigoja kompensuoti Å¾alÄ…, jei tokia atsiras</li>
              </ol>
              
              <h4 style="margin-top: 20px; font-size: 12px; font-weight: bold;">BENDRASAVININKÅ² PARAÅ Å² LENTELÄ–:</h4>
              
              <table style="width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 10px;">
                <thead>
                  <tr style="background: #e5e7eb;">
                    <th style="border: 1px solid #999; padding: 5px; text-align: left;">Nr.</th>
                    <th style="border: 1px solid #999; padding: 5px; text-align: left;">Buto Nr.</th>
                    <th style="border: 1px solid #999; padding: 5px; text-align: left;">Savininkas (V.P.)</th>
                    <th style="border: 1px solid #999; padding: 5px; text-align: left;">Asmens kodas</th>
                    <th style="border: 1px solid #999; padding: 5px; text-align: left;">ParaÅ¡as</th>
                    <th style="border: 1px solid #999; padding: 5px; text-align: left;">Data</th>
                  </tr>
                </thead>
                <tbody>
                  ${Array.from({length: 10}, (_, i) => `
                    <tr>
                      <td style="border: 1px solid #999; padding: 5px;">${i+1}.</td>
                      <td style="border: 1px solid #999; padding: 5px;">&nbsp;</td>
                      <td style="border: 1px solid #999; padding: 5px;">&nbsp;</td>
                      <td style="border: 1px solid #999; padding: 5px;">&nbsp;</td>
                      <td style="border: 1px solid #999; padding: 5px;">&nbsp;</td>
                      <td style="border: 1px solid #999; padding: 5px;">&nbsp;</td>
                    </tr>
                  `).join('')}
                </tbody>
              </table>
              
              <p style="margin-top: 15px; font-size: 9px; font-style: italic;">
                <strong>PASTABA:</strong> Pagal CivilinÄ¯ kodeksÄ… (4.75 str.), reikia VISÅ² savininkÅ³ sutikimo.
              </p>
            </div>
          ` : ''}
          
          <!-- Instructions page -->
          <div style="page-break-before: always; padding-top: 0;">
            <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 15px; text-align: center; margin: -20px -20px 20px -20px;">
              <h2 style="margin: 0; font-size: 18px; font-weight: bold;">INSTRUKCIJOS IR TOLIMESNI Å½INGSNIAI</h2>
            </div>
            
            <div style="margin: 20px 0;">
              <div style="background: #dbeafe; border-left: 4px solid #2563eb; padding: 12px; margin: 15px 0;">
                <h4 style="margin: 0 0 8px 0; font-size: 12px;">
                  <span style="background: #2563eb; color: white; border-radius: 50%; padding: 2px 8px; margin-right: 8px;">1</span>
                  ${isApartment ? 'Surinkite bendrasavininkÅ³ sutikimus' : 'ParuoÅ¡kite dokumentus'}
                </h4>
                <p style="margin: 0; font-size: 10px;">
                  ${needsCoOwnerDocs ? 
                    'Naudokite Å¡iame PDF esantÄ¯ Å¡ablonÄ… (Dokumentas #2). Surinkite visÅ³ bendrasavininkÅ³ paraÅ¡us arba suÅ¡aukite bendrÄ… susirinkimÄ… ir patvirtinkite sprendimÄ… protokolu. Laikas: 1-4 savaitÄ—s.' :
                    hasCoOwnerDocs ? 'JÅ«sÅ³ turimas sutikimas jau yra tinkamas - Ä¯kelkite jÄ¯ sistemoje.' :
                    'Individualiems namams nereikia bendrasavininkÅ³ sutikimo - pereikite prie kito Å¾ingsnio.'}
                </p>
              </div>
              
              <div style="background: #fef3c7; border-left: 4px solid #f59e0b; padding: 12px; margin: 15px 0;">
                <h4 style="margin: 0 0 8px 0; font-size: 12px;">
                  <span style="background: #f59e0b; color: white; border-radius: 50%; padding: 2px 8px; margin-right: 8px;">2</span>
                  Gaukite NT registro iÅ¡raÅ¡Ä…
                </h4>
                <p style="margin: 0; font-size: 10px;">
                  <strong>Kaip gauti:</strong><br/>
                  â€¢ Internetu: <strong>www.registrucentras.lt/paslaugos</strong> (reikia prisijungti per el. valdÅ¾ios vartus)<br/>
                  â€¢ Tel.: 1884 (darbo dienomis 8-17 val.)<br/>
                  â€¢ Kaina: 2-3 EUR<br/>
                  â€¢ TrukmÄ—: IÅ¡ karto (elektroninis) arba 1-3 d.d. (popierinis)<br/>
                  â€¢ Reikalingas: Nekilnojamojo turto registro iÅ¡raÅ¡as (pilna forma)
                </p>
              </div>
              
              <div style="background: #e0e7ff; border-left: 4px solid #6366f1; padding: 12px; margin: 15px 0;">
                <h4 style="margin: 0 0 8px 0; font-size: 12px;">
                  <span style="background: #6366f1; color: white; border-radius: 50%; padding: 2px 8px; margin-right: 8px;">3</span>
                  KreipkitÄ—s Ä¯ ESO dÄ—l prijungimo sÄ…lygÅ³
                </h4>
                <p style="margin: 0; font-size: 10px;">
                  <strong>Kaip gauti:</strong><br/>
                  â€¢ Internetu: <strong>www.eso.lt</strong> > Paslaugos > Naujo objekto prijungimas<br/>
                  â€¢ Tel.: <strong>1852</strong> (darbo dienomis 8-17 val.)<br/>
                  â€¢ TrukmÄ—: 5-10 darbo dienÅ³<br/>
                  â€¢ Kaina: Nemokama<br/>
                  â€¢ Reikalingi dokumentai: PareiÅ¡kimas (1 dok.), NT iÅ¡raÅ¡as, techninÄ— specifikacija
                </p>
              </div>
              
              <div style="background: #f3e8ff; border-left: 4px solid #a855f7; padding: 12px; margin: 15px 0;">
                <h4 style="margin: 0 0 8px 0; font-size: 12px;">
                  <span style="background: #a855f7; color: white; border-radius: 50%; padding: 2px 8px; margin-right: 8px;">4</span>
                  Pasirinkite rangovÄ… su VERT atestu
                </h4>
                <p style="margin: 0; font-size: 10px;">
                  <strong>Rangovai (pavyzdÅ¾iai):</strong><br/>
                  â€¢ Charge In: www.chargein.lt, +370 612 77700<br/>
                  â€¢ Solet Technics: www.solet.lt, +370 614 51775<br/>
                  â€¢ Elektrum: www.elektrum.lt<br/>
                  â€¢ VERT atestuotÅ³ elektrikÅ³ sÄ…raÅ¡as: <strong>www.vert.lt</strong>
                </p>
              </div>
              
              <div style="background: #dcfce7; border-left: 4px solid #10b981; padding: 12px; margin: 15px 0;">
                <h4 style="margin: 0 0 8px 0; font-size: 12px;">
                  <span style="background: #10b981; color: white; border-radius: 50%; padding: 2px 8px; margin-right: 8px;">5</span>
                  Atlikite Ä¯rengimo darbus
                </h4>
                <p style="margin: 0; font-size: 10px;">
                  TrukmÄ—: 1-3 dienos (priklauso nuo vietos ir kabelio ilgio)<br/>
                  Kaina: 800-2000 EUR (+ stotelÄ— 500-1500 EUR)<br/>
                  <strong>Svarbu:</strong> Rangovas privalo turÄ—ti VERT atestÄ… ir pateikti visus reikalingus sertifikatus!
                </p>
              </div>
              
              <div style="background: #fef2f2; border-left: 4px solid #ef4444; padding: 12px; margin: 15px 0;">
                <h4 style="margin: 0 0 8px 0; font-size: 12px;">
                  <span style="background: #ef4444; color: white; border-radius: 50%; padding: 2px 8px; margin-right: 8px;">6</span>
                  Gauti ESO priÄ—mimo aktÄ…
                </h4>
                <p style="margin: 0; font-size: 10px;">
                  Po darbÅ³ uÅ¾baigimo ESO atliks patikrinimÄ… ir iÅ¡duos priÄ—mimo aktÄ….<br/>
                  TrukmÄ—: 3-5 darbo dienos po kreipimosi<br/>
                  Kaina: Nemokama
                </p>
              </div>
              
              <div style="background: #fef9c3; border-left: 4px solid #eab308; padding: 12px; margin: 15px 0;">
                <h4 style="margin: 0 0 8px 0; font-size: 12px;">
                  <span style="background: #eab308; color: white; border-radius: 50%; padding: 2px 8px; margin-right: 8px;">7</span>
                  PraÅ¡ykite ENA subsidijos
                </h4>
                <p style="margin: 0; font-size: 10px;">
                  <strong>Subsidijos dydis:</strong><br/>
                  â€¢ DaugiabuÄiams: iki 60% (maks. 1,500 EUR)<br/>
                  â€¢ Privatiems namams: iki 40% (maks. 1,500 EUR)<br/>
                  <br/>
                  <strong>Dokumentai reikalingi ENA:</strong><br/>
                  â€¢ Å is pareiÅ¡kimas (#1)<br/>
                  â€¢ NT iÅ¡raÅ¡as<br/>
                  â€¢ BendrasavininkÅ³ sutikimas (jei daugiabuÄiame name)<br/>
                  â€¢ ESO prijungimo sÄ…lygos ir priÄ—mimo aktas<br/>
                  â€¢ Rangos sutartis ir sÄ…skaitos<br/>
                  â€¢ StotelÄ—s sertifikatai<br/>
                  <br/>
                  <strong>Kreipimasis:</strong> <strong>www.ena.lt</strong> arba el. paÅ¡tas: <strong>info@ena.lt</strong><br/>
                  <br/>
                  <strong style="color: #dc2626;">âš ï¸ SVARBU:</strong> Programa galioja iki 2025 m. rugsÄ—jo! SkubÄ—kite!
                </p>
              </div>
            </div>
            
            <div style="background: #f9fafb; border: 1px solid #e5e7eb; padding: 15px; margin-top: 20px;">
              <h4 style="margin: 0 0 10px 0; font-size: 12px; font-weight: bold;">ğŸ“ KONTAKTAI</h4>
              <div style="font-size: 10px; line-height: 1.6;">
                <p><strong>ENA (Energetikos agentÅ«ra):</strong> www.ena.lt, info@ena.lt</p>
                <p><strong>ESO (Elektros skirstymo operatorius):</strong> www.eso.lt, tel. 1852</p>
                <p><strong>RegistrÅ³ centras:</strong> www.registrucentras.lt, tel. 1884</p>
                <p><strong>VERT (ValstybinÄ— energetikos reguliavimo taryba):</strong> www.vert.lt</p>
              </div>
            </div>
          </div>
        </div>
      `;
      
      // Generate PDF using html2pdf
      const opt = {
        margin: 0,
        filename: `ev-docs-${d.fullName.replace(/\s+/g, '-')}.pdf`,
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2, useCORS: true },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };
      
      html2pdf().set(opt).from(htmlContent).save();
    }

    function allDocsUploaded() {
      const isApartment = state.data.propertyType === 'apartment';
      const pageHeight = doc.internal.pageSize.height;
      const margin = 20;
      const maxWidth = pageWidth - 2 * margin;
      
      // Helper functions
      const addText = (text, size = 10, style = 'normal', align = 'left') => {
        doc.setFontSize(size);
        doc.setFont('helvetica', style);
        if (align === 'center') {
          doc.text(text, pageWidth / 2, y, { align: 'center' });
        } else {
          const lines = doc.splitTextToSize(text, maxWidth);
          doc.text(lines, margin, y);
          y += lines.length * (size * 0.35);
        }
        y += size * 0.2;
      };
      
      const addLine = () => {
        doc.setDrawColor(200, 200, 200);
        doc.line(margin, y, pageWidth - margin, y);
        y += 5;
      };
      
      const checkPageBreak = (space = 20) => {
        if (y + space > pageHeight - margin) {
          doc.addPage();
          y = margin;
        }
      };
      
      // Title
      doc.setFillColor(37, 99, 235);
      doc.rect(0, 0, pageWidth, 40, 'F');
      doc.setTextColor(255, 255, 255);
      doc.setFontSize(20);
      doc.setFont('helvetica', 'bold');
      doc.text('EV DOCS LT', pageWidth / 2, 15, { align: 'center' });
      doc.setFontSize(12);
      doc.text('ElektromobiliÅ³ krovimo stotelÄ—s dokumentai', pageWidth / 2, 25, { align: 'center' });
      doc.setFontSize(9);
      doc.text(new Date().toLocaleDateString('lt-LT'), pageWidth / 2, 32, { align: 'center' });
      
      doc.setTextColor(0, 0, 0);
      y = 50;
      
      // DOKUMENTAS 1: PAREIÅ KIMAS
      doc.setFillColor(243, 244, 246);
      doc.rect(margin, y, maxWidth, 10, 'F');
      doc.setFontSize(14);
      doc.setFont('helvetica', 'bold');
      doc.text('DOKUMENTAS #1: PAREIÅ KIMAS', margin + 5, y + 7);
      y += 15;
      
      addText(`DÄ—l elektromobilio Ä¯krovimo stotelÄ—s Ä¯rengimo`, 11, 'bold', 'center');
      y += 5;
      
      if (isApartment) {
        addText(`DaugiabuÄio namo ${d.address}`);
        addText('ButÅ³ ir kitÅ³ patalpÅ³ savininkams');
      } else {
        addText(`Adresas: ${d.address}`);
      }
      y += 5;
      
      addText('PAREIÅ KÄ–JO DUOMENYS:', 11, 'bold');
      addText(`Vardas, pavardÄ—: ${d.fullName}`);
      addText(`Asmens kodas: ${d.personalCode}`);
      addText(`Adresas: ${d.address}`);
      if (isApartment) addText(`Buto numeris: ${d.apartmentNumber}`);
      addText(`Telefonas: ${d.phone}`);
      addText(`El. paÅ¡tas: ${d.email}`);
      y += 5;
      
      addText(isApartment ? 'PRAÅ AU LEISTI Ä®RENGTI:' : 'INFORMUOJU APIE KETINIMÄ„ Ä®RENGTI:', 11, 'bold');
      addText(`Elektromobilio Ä¯krovimo stotelÄ™ ${isApartment ? 'parkavimo vietoje Nr. ' + d.parkingSpot : 'savo teritorijoje'}, esanÄioje ${d.parkingLocation}.`);
      y += 3;
      
      addText('STOTELÄ–S PARAMETRAI:', 11, 'bold');
      addText(`â€¢ Tipas: ${d.chargerType}`);
      addText(`â€¢ Galia: ${d.power} kW`);
      addText(`â€¢ PrieigÅ³ skaiÄius: ${d.connectors}`);
      if (d.chargerModel) addText(`â€¢ Modelis: ${d.chargerModel}`);
      y += 5;
      
      addText('Ä®SIPAREIGOJIMAI:', 11, 'bold');
      addText('â€¢ Laikytis visÅ³ Lietuvos Respublikos statybos ir elektros saugos reikalavimÅ³');
      addText('â€¢ Naudoti tik sertifikuotÄ… ir naujÄ… Ä¯rangÄ…');
      addText('â€¢ Ä®rengimo darbus pavesti atestuotam rangovui su VERT atestu');
      addText('â€¢ Tinkamai eksploatuoti ir priÅ¾iÅ«rÄ—ti Ä¯rengtÄ… stotelÄ™');
      if (isApartment) addText('â€¢ Kompensuoti Å¾alÄ… bendriesiems objektams, jei tokia atsiras');
      y += 10;
      
      addText('PareiÅ¡kÄ—jas: ___________________________');
      addText(`                    (${d.fullName})`);
      addText(`Data: ${new Date().toLocaleDateString('lt-LT')}`);
      
      checkPageBreak(40);
      y += 10;
      addLine();
      y += 5;
      
      // DOKUMENTAS 2: BENDRASAVININKÅ² SUTIKIMAS (jei reikia)
      if (needsCoOwnerDocs) {
        checkPageBreak(100);
        
        doc.setFillColor(243, 244, 246);
        doc.rect(margin, y, maxWidth, 10, 'F');
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('DOKUMENTAS #2: BENDRASAVININKÅ² SUTIKIMAS', margin + 5, y + 7);
        y += 15;
        
        addText(`DaugiabuÄio namo ${d.address}`, 11, 'bold', 'center');
        addText('BENDRASAVININKÅ² SUTIKIMAS', 11, 'bold', 'center');
        addText('DÄ–L EV Ä®KROVIMO STOTELÄ–S Ä®RENGIMO', 11, 'bold', 'center');
        y += 5;
        
        addText(`Mes, Å¾emiau pasiraÅ¡Ä™ daugiabuÄio namo butÅ³ ir kitÅ³ patalpÅ³ savininkai, SUTINKAME, kad ${d.fullName}, buto Nr. ${d.apartmentNumber} savininkas(-Ä—), Ä¯rengtÅ³ elektromobilio Ä¯krovimo stotelÄ™ parkavimo vietoje Nr. ${d.parkingSpot}.`);
        y += 5;
        
        addText('STOTELÄ–S PARAMETRAI:', 11, 'bold');
        addText(`â€¢ Galia: ${d.power} kW`);
        addText(`â€¢ Tipas: ${d.chargerType}`);
        addText(`â€¢ PrieigÅ³ skaiÄius: ${d.connectors}`);
        y += 5;
        
        addText('SÄ„LYGOS:', 11, 'bold');
        addText('1. StotelÄ— bus Ä¯rengta pagal LR statybos ir elektros Ä¯renginiÅ³ reikalavimus');
        addText('2. Bus naudojama tik sertifikuota ir nauja Ä¯ranga');
        addText('3. Darbai bus atliekami atestuoto rangovo su VERT atestu');
        addText('4. Bus gautos ir Ä¯vykdytos ESO prijungimo sÄ…lygos');
        addText('5. PareiÅ¡kÄ—jas Ä¯sipareigoja kompensuoti Å¾alÄ…, jei tokia atsiras');
        y += 10;
        
        addText('BENDRASAVININKÅ² PARAÅ Å² LENTELÄ–:', 11, 'bold');
        y += 5;
        
        // LentelÄ—
        const tableY = y;
        const colWidths = [15, 25, 50, 40, 30, 30];
        const rowHeight = 10;
        
        // Header
        doc.setFillColor(230, 230, 230);
        doc.rect(margin, tableY, maxWidth, rowHeight, 'F');
        doc.setFontSize(9);
        doc.setFont('helvetica', 'bold');
        const headers = ['Nr.', 'Buto Nr.', 'Savininkas (V.P.)', 'Asmens kodas', 'ParaÅ¡as', 'Data'];
        let xPos = margin;
        headers.forEach((header, i) => {
          doc.text(header, xPos + 2, tableY + 7);
          xPos += colWidths[i];
        });
        
        // Rows
        doc.setFont('helvetica', 'normal');
        for (let i = 0; i < 10; i++) {
          const rowY = tableY + (i + 1) * rowHeight;
          doc.rect(margin, rowY, maxWidth, rowHeight);
          xPos = margin;
          colWidths.forEach(width => {
            doc.line(xPos, rowY, xPos, rowY + rowHeight);
            xPos += width;
          });
          doc.text(`${i + 1}.`, margin + 2, rowY + 7);
        }
        
        y = tableY + 11 * rowHeight + 10;
        
        checkPageBreak(30);
        addText('PASTABA: Pagal CivilinÄ¯ kodeksÄ… (4.75 str.), reikia VISÅ² savininkÅ³ sutikimo.', 9, 'italic');
      }
      
      // INSTRUKCIJOS
      doc.addPage();
      y = margin;
      
      doc.setFillColor(16, 185, 129);
      doc.rect(0, 0, pageWidth, 30, 'F');
      doc.setTextColor(255, 255, 255);
      doc.setFontSize(16);
      doc.setFont('helvetica', 'bold');
      doc.text('INSTRUKCIJOS IR TOLIMESNI Å½INGSNIAI', pageWidth / 2, 20, { align: 'center' });
      
      doc.setTextColor(0, 0, 0);
      y = 45;
      
      // Å½ingsniai
      const steps = [
        {
          num: '1',
          title: 'Surinkite bendrasavininkÅ³ sutikimus',
          desc: needsCoOwnerDocs ? 
            'Naudokite Å¡iame PDF esantÄ¯ Å¡ablonÄ… (Dokumentas #2). Surinkite visÅ³ bendrasavininkÅ³ paraÅ¡us arba suÅ¡aukite bendrÄ… susirinkimÄ… ir patvirtinkite sprendimÄ… protokolu.' :
            hasCoOwnerDocs ? 'JÅ«sÅ³ turimas sutikimas jau yra tinkamas - Ä¯kelkite jÄ¯ sistemoje.' :
            'Individualiems namams nereikia bendrasavininkÅ³ sutikimo - pereikite prie kito Å¾ingsnio.',
          skip: !isApartment
        },
        {
          num: '2',
          title: 'Gaukite NT registro iÅ¡raÅ¡Ä…',
          desc: 'Kaip gauti:\nâ€¢ Internetu: www.registrucentras.lt/paslaugos (reikia prisijungti per el. valdÅ¾ios vartus)\nâ€¢ Kaina: 2-3 EUR\nâ€¢ TrukmÄ—: IÅ¡ karto (elektroninis) arba 1-3 d.d. (popierinis)\nâ€¢ Reikalingas dokumentas: Nekilnojamojo turto registro iÅ¡raÅ¡as (pilna forma)'
        },
        {
          num: '3',
          title: 'KreipkitÄ—s Ä¯ ESO dÄ—l prijungimo sÄ…lygÅ³',
          desc: 'Kaip gauti:\nâ€¢ Internetu: www.eso.lt > Paslaugos > Naujo objekto prijungimas\nâ€¢ Tel.: 1852 (darbo dienomis 8-17 val.)\nâ€¢ TrukmÄ—: 5-10 darbo dienÅ³\nâ€¢ Kaina: Nemokama\nâ€¢ Reikalingi dokumentai: PareiÅ¡kimas (1 dok.), NT iÅ¡raÅ¡as, techninÄ— EV stotelÄ—s specifikacija'
        },
        {
          num: '4',
          title: 'Pasirinkite rangovÄ… su VERT atestu',
          desc: 'Rangovai (pavyzdÅ¾iai):\nâ€¢ Charge In: www.chargein.lt, +370 612 77700\nâ€¢ Solet Technics: www.solet.lt, +370 614 51775\nâ€¢ Elektrum: www.elektrum.lt\nâ€¢ Arba ieÅ¡kokite VERT atestuotÅ³ elektrikÅ³ sÄ…raÅ¡o: www.vert.lt'
        },
        {
          num: '5',
          title: 'Pateikite paraiÅ¡kÄ… ENA paramai',
          desc: 'PrieÅ¡ Ä¯rengimÄ…:\nâ€¢ SvetainÄ—: www.ena.lt > Parama > EV stotelÄ—s\nâ€¢ Reikalingi dokumentai: PareiÅ¡kimas, NT iÅ¡raÅ¡as, ESO sÄ…lygos, sutikimai\nâ€¢ Laukite patvirtinimo (5-10 d.d.)\n\nPo Ä¯rengimo (mokÄ—jimo praÅ¡ymui):\nâ€¢ PVM sÄ…skaita faktÅ«ra\nâ€¢ Perdavimo-priÄ—mimo aktas\nâ€¢ TechninÄ— specifikacija\nâ€¢ VERT atesto kopija\nâ€¢ Bandymo protokolai\nâ€¢ StotelÄ—s nuotraukos'
        }
      ];
      
      steps.forEach(step => {
        if (step.skip) return;
        
        checkPageBreak(50);
        
        // Å½ingsnio numeris
        doc.setFillColor(37, 99, 235);
        doc.circle(margin + 7, y + 5, 7, 'F');
        doc.setTextColor(255, 255, 255);
        doc.setFontSize(12);
        doc.setFont('helvetica', 'bold');
        doc.text(step.num, margin + 7, y + 7, { align: 'center' });
        
        // Å½ingsnio tekstas
        doc.setTextColor(0, 0, 0);
        doc.setFontSize(11);
        doc.text(step.title, margin + 20, y + 7);
        
        y += 12;
        doc.setFontSize(9);
        doc.setFont('helvetica', 'normal');
        const descLines = step.desc.split('\n');
        descLines.forEach(line => {
          const wrapped = doc.splitTextToSize(line, maxWidth - 25);
          doc.text(wrapped, margin + 20, y);
          y += wrapped.length * 4;
        });
        
        y += 8;
      });
      
      // Parama info box
      checkPageBreak(60);
      y += 5;
      doc.setFillColor(254, 243, 199);
      doc.rect(margin, y, maxWidth, 45, 'F');
      doc.setDrawColor(251, 191, 36);
      doc.setLineWidth(2);
      doc.rect(margin, y, maxWidth, 45);
      doc.setLineWidth(0.5);
      
      doc.setFontSize(12);
      doc.setFont('helvetica', 'bold');
      doc.text('ğŸ’° PARAMA', margin + 5, y + 10);
      
      doc.setFontSize(10);
      doc.setFont('helvetica', 'normal');
      doc.text(`â€¢ Dydis: ${isApartment ? '60%' : '40%'} Ä¯rengimo iÅ¡laidÅ³`, margin + 5, y + 20);
      doc.text('â€¢ Maksimali suma: iki 1,500 EUR vienai stotelei', margin + 5, y + 28);
      doc.text('â€¢ Programa galioja iki: 2025 m. rugsÄ—jo mÄ—n. (tikslinkite!)', margin + 5, y + 36);
      
      // Footer
      y = pageHeight - 15;
      doc.setFontSize(8);
      doc.setTextColor(128, 128, 128);
      doc.text('Sugeneruota: ' + new Date().toLocaleString('lt-LT'), margin, y);
      doc.text('Sistema: EV Docs LT v1.0 MVP | www.evdocs.lt', pageWidth - margin, y, { align: 'right' });
      
      doc.save(`EV-Docs-${state.data.fullName.replace(/\s+/g, '-')}-${Date.now()}.pdf`);
    }

    function allDocsUploaded() {
      const isApartment = state.data.propertyType === 'apartment';
      const isTenant = state.data.ownership === 'tenant';
      const needsCoOwnerDocs = isApartment && state.data.hasCoOwnerConsent === 'yes';
      
      return state.files.propertyDeed && 
             state.files.esoConditions &&
             (!needsCoOwnerDocs || state.files.coOwnerConsent) &&
             (!isTenant || state.files.landlordConsent);
    }

    function sendToInstitutions(event) {
      if (event) event.preventDefault();
      
      if (confirm('ğŸ“§ Ar tikrai norite iÅ¡siÅ³sti dokumentus Ä¯ ENA sistemÄ…?')) {
        alert('âœ… Dokumentai sÄ—kmingai iÅ¡siÅ³sti!\\n\\nParaiÅ¡kos numeris: EV-' + Date.now() + 
              '\\nEl. paÅ¡tas: ' + state.data.email + 
              '\\n\\nJÅ«sÅ³ paraiÅ¡kÄ… perÅ¾iÅ«rÄ—s per 5-10 darbo dienÅ³.\\n' +
              '\\nğŸ“§ MVP versijoje - tai tik simuliacija.');
      }
    }

    // Render functions
    function renderLanding() {
      return `
        <div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50">
          <nav class="bg-white/80 backdrop-blur-md border-b border-gray-200 sticky top-0 z-50">
            <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
              <div class="flex items-center gap-2">
                <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                </svg>
                <span class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-green-600 bg-clip-text text-transparent">
                  EV Docs LT
                </span>
              </div>
              <button onclick="changePage('form')" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-all">
                PradÄ—ti dabar
              </button>
            </div>
          </nav>

          <div class="max-w-6xl mx-auto px-4 py-20">
            <div class="text-center mb-16">
              <div class="inline-block mb-4">
                <span class="bg-blue-100 text-blue-800 px-4 py-2 rounded-full text-sm font-semibold">
                  ğŸš€ MVP Beta versija
                </span>
              </div>
              <h1 class="text-5xl md:text-6xl font-bold mb-6 leading-tight">
                EV StotelÄ—s Dokumentai
                <br />
                <span class="bg-gradient-to-r from-blue-600 to-green-600 bg-clip-text text-transparent">
                  Per 5 Minutes
                </span>
              </h1>
              <p class="text-xl text-gray-600 mb-8 max-w-2xl mx-auto">
                AutomatiÅ¡kai sugeneruokite visus reikalingus dokumentus elektromobilio 
                krovimo stotelÄ—s Ä¯rengimui. Sutaupykite laikÄ… ir iÅ¡venkite klaidÅ³.
              </p>
              <button onclick="changePage('form')" class="bg-blue-600 text-white px-8 py-4 rounded-lg font-semibold text-lg hover:bg-blue-700 transition-all shadow-lg">
                Sukurti dokumentus â†’
              </button>
            </div>

            <div class="grid md:grid-cols-3 gap-8 mb-16">
              <div class="bg-white p-8 rounded-2xl shadow-lg">
                <div class="bg-blue-100 w-14 h-14 rounded-lg flex items-center justify-center mb-4">
                  <svg class="w-7 h-7 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
                  </svg>
                </div>
                <h3 class="text-xl font-bold mb-3">Greitas procesas</h3>
                <p class="text-gray-600">
                  Atsakykite Ä¯ klausimus ir gaukite dokumentus per 5 minutes.
                </p>
              </div>

              <div class="bg-white p-8 rounded-2xl shadow-lg">
                <div class="bg-green-100 w-14 h-14 rounded-lg flex items-center justify-center mb-4">
                  <svg class="w-7 h-7 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                  </svg>
                </div>
                <h3 class="text-xl font-bold mb-3">TeisiÅ¡kai teisingi</h3>
                <p class="text-gray-600">
                  Visi dokumentai atitinka LT teisÄ—s aktÅ³ reikalavimus.
                </p>
              </div>

              <div class="bg-white p-8 rounded-2xl shadow-lg">
                <div class="bg-purple-100 w-14 h-14 rounded-lg flex items-center justify-center mb-4">
                  <svg class="w-7 h-7 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"></path>
                  </svg>
                </div>
                <h3 class="text-xl font-bold mb-3">Pilnas paketas</h3>
                <p class="text-gray-600">
                  Gaukite visus dokumentus ir iÅ¡siÅ³skite Ä¯ ENA sistemÄ….
                </p>
              </div>
            </div>

            <div class="bg-gradient-to-r from-blue-600 to-green-600 rounded-2xl p-12 text-white text-center">
              <div class="grid md:grid-cols-3 gap-8">
                <div>
                  <div class="text-5xl font-bold mb-2">60%</div>
                  <div class="text-blue-100">Parama daugiabuÄiams</div>
                </div>
                <div>
                  <div class="text-5xl font-bold mb-2">5 min</div>
                  <div class="text-blue-100">DokumentÅ³ generavimas</div>
                </div>
                <div>
                  <div class="text-5xl font-bold mb-2">100%</div>
                  <div class="text-blue-100">Atitiktis reikalavimams</div>
                </div>
              </div>
            </div>
          </div>

          <footer class="bg-gray-900 text-white py-8 mt-20">
            <div class="max-w-6xl mx-auto px-4 text-center">
              <p class="text-gray-400">Â© 2025 EV Docs LT. MVP versija. Sukurta su â¤ï¸ Lietuvoje.</p>
            </div>
          </footer>
        </div>
      `;
    }

    function renderForm() {
      const currentStepData = steps[state.step];
      const isApartment = state.data.propertyType === 'apartment';
      const isTenant = state.data.ownership === 'tenant';
      
      let formFields = '';
      
      if (state.step === 0) {
        formFields = `
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Vardas ir PavardÄ— *</label>
            <input type="text" id="fullName" value="${state.data.fullName}" 
              onchange="updateData('fullName', this.value)" placeholder="Jonas Jonaitis"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${state.errors.fullName ? 'border-red-500' : 'border-gray-300'}">
            ${state.errors.fullName ? `<p class="text-red-500 text-sm mt-1">${state.errors.fullName}</p>` : ''}
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Asmens kodas *</label>
            <input type="text" id="personalCode" value="${state.data.personalCode}" maxlength="11"
              onchange="updateData('personalCode', this.value)" placeholder="39001010000"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${state.errors.personalCode ? 'border-red-500' : 'border-gray-300'}">
            ${state.errors.personalCode ? `<p class="text-red-500 text-sm mt-1">${state.errors.personalCode}</p>` : ''}
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Telefonas *</label>
            <input type="tel" id="phone" value="${state.data.phone}"
              onchange="updateData('phone', this.value)" placeholder="+370 600 00000"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${state.errors.phone ? 'border-red-500' : 'border-gray-300'}">
            ${state.errors.phone ? `<p class="text-red-500 text-sm mt-1">${state.errors.phone}</p>` : ''}
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">El. paÅ¡tas *</label>
            <input type="email" id="email" value="${state.data.email}"
              onchange="updateData('email', this.value)" placeholder="jonas@example.lt"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${state.errors.email ? 'border-red-500' : 'border-gray-300'}">
            ${state.errors.email ? `<p class="text-red-500 text-sm mt-1">${state.errors.email}</p>` : ''}
          </div>
        `;
      } else if (state.step === 1) {
        formFields = `
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Pilnas adresas *</label>
            <input type="text" id="address" value="${state.data.address}"
              onchange="updateData('address', this.value)" placeholder="Gedimino pr. 1, Vilnius"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${state.errors.address ? 'border-red-500' : 'border-gray-300'}">
            ${state.errors.address ? `<p class="text-red-500 text-sm mt-1">${state.errors.address}</p>` : ''}
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Turto tipas *</label>
            <div class="grid grid-cols-2 gap-4">
              <button type="button" onclick="updateData('propertyType', 'apartment')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.propertyType === 'apartment' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                ğŸ¢ Daugiabutis
              </button>
              <button type="button" onclick="updateData('propertyType', 'house')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.propertyType === 'house' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                ğŸ  Individualus namas
              </button>
            </div>
            ${state.errors.propertyType ? `<p class="text-red-500 text-sm mt-1">${state.errors.propertyType}</p>` : ''}
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">NuosavybÄ—s statusas *</label>
            <div class="grid grid-cols-2 gap-4">
              <button type="button" onclick="updateData('ownership', 'owner')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.ownership === 'owner' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                Savininkas
              </button>
              <button type="button" onclick="updateData('ownership', 'tenant')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.ownership === 'tenant' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                Nuomininkas
              </button>
            </div>
            ${state.errors.ownership ? `<p class="text-red-500 text-sm mt-1">${state.errors.ownership}</p>` : ''}
          </div>
          ${isApartment ? `
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Buto numeris *</label>
            <input type="text" id="apartmentNumber" value="${state.data.apartmentNumber}"
              onchange="updateData('apartmentNumber', this.value)" placeholder="15"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${state.errors.apartmentNumber ? 'border-red-500' : 'border-gray-300'}">
            ${state.errors.apartmentNumber ? `<p class="text-red-500 text-sm mt-1">${state.errors.apartmentNumber}</p>` : ''}
          </div>
          ` : ''}
        `;
      } else if (state.step === 2) {
        formFields = `
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Parkavimo vietos vieta *</label>
            <div class="grid grid-cols-3 gap-4">
              <button type="button" onclick="updateData('parkingLocation', 'PoÅ¾eminÄ—je stovÄ—jimo aikÅ¡telÄ—je')"
                class="p-4 border-2 rounded-lg font-semibold text-sm transition-all ${state.data.parkingLocation === 'PoÅ¾eminÄ—je stovÄ—jimo aikÅ¡telÄ—je' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                PoÅ¾eminÄ—
              </button>
              <button type="button" onclick="updateData('parkingLocation', 'Kieme')"
                class="p-4 border-2 rounded-lg font-semibold text-sm transition-all ${state.data.parkingLocation === 'Kieme' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                Kieme
              </button>
              <button type="button" onclick="updateData('parkingLocation', 'GaraÅ¾e')"
                class="p-4 border-2 rounded-lg font-semibold text-sm transition-all ${state.data.parkingLocation === 'GaraÅ¾e' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                GaraÅ¾e
              </button>
            </div>
            ${state.errors.parkingLocation ? `<p class="text-red-500 text-sm mt-1">${state.errors.parkingLocation}</p>` : ''}
          </div>
          ${isApartment ? `
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Parkavimo vietos numeris *</label>
            <input type="text" id="parkingSpot" value="${state.data.parkingSpot}"
              onchange="updateData('parkingSpot', this.value)" placeholder="12"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 ${state.errors.parkingSpot ? 'border-red-500' : 'border-gray-300'}">
            ${state.errors.parkingSpot ? `<p class="text-red-500 text-sm mt-1">${state.errors.parkingSpot}</p>` : ''}
          </div>
          ` : ''}
        `;
      } else if (state.step === 3) {
        formFields = `
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">StotelÄ—s tipas *</label>
            <div class="grid grid-cols-2 gap-4">
              <button type="button" onclick="updateData('chargerType', 'SieninÄ—')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.chargerType === 'SieninÄ—' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                ğŸ”Œ SieninÄ—
              </button>
              <button type="button" onclick="updateData('chargerType', 'Ant Å¾emÄ—s')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.chargerType === 'Ant Å¾emÄ—s' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                âš¡ Ant Å¾emÄ—s
              </button>
            </div>
            ${state.errors.chargerType ? `<p class="text-red-500 text-sm mt-1">${state.errors.chargerType}</p>` : ''}
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">StotelÄ—s galia *</label>
            <div class="grid grid-cols-3 gap-4">
              <button type="button" onclick="updateData('power', '7.4')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.power === '7.4' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                7.4 kW
              </button>
              <button type="button" onclick="updateData('power', '11')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.power === '11' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                11 kW
              </button>
              <button type="button" onclick="updateData('power', '22')"
                class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.power === '22' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                22 kW
              </button>
            </div>
            ${state.errors.power ? `<p class="text-red-500 text-sm mt-1">${state.errors.power}</p>` : ''}
            <p class="text-sm text-gray-500 mt-2">ğŸ’¡ Rekomenduojama 11 kW namÅ³ naudojimui</p>
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">PrieigÅ³ skaiÄius *</label>
            <select onchange="updateData('connectors', this.value)" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
              <option value="1" ${state.data.connectors === '1' ? 'selected' : ''}>1 prieiga</option>
              <option value="2" ${state.data.connectors === '2' ? 'selected' : ''}>2 prieigos</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">StotelÄ—s modelis (neprivaloma)</label>
            <input type="text" id="chargerModel" value="${state.data.chargerModel || ''}"
              onchange="updateData('chargerModel', this.value)" placeholder="pvz. Tesla Wall Connector"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg">
          </div>
        `;
      } else if (state.step === 4) {
        if (isApartment) {
          formFields = `
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">Ar jau turite bendrasavininkÅ³ sutikimÄ…? *</label>
              <div class="grid grid-cols-2 gap-4">
                <button type="button" onclick="updateData('hasCoOwnerConsent', 'yes')"
                  class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.hasCoOwnerConsent === 'yes' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                  âœ… Taip, turiu
                </button>
                <button type="button" onclick="updateData('hasCoOwnerConsent', 'no')"
                  class="p-4 border-2 rounded-lg font-semibold transition-all ${state.data.hasCoOwnerConsent === 'no' ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-300'}">
                  âŒ Ne, reikia Å¡ablono
                </button>
              </div>
              ${state.errors.hasCoOwnerConsent ? `<p class="text-red-500 text-sm mt-1">${state.errors.hasCoOwnerConsent}</p>` : ''}
              
              ${state.data.hasCoOwnerConsent === 'yes' ? `
                <div class="mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                  <h4 class="font-semibold text-blue-900 mb-2">ğŸ“„ Ä®kelkite bendrasavininkÅ³ sutikimÄ…</h4>
                  <p class="text-sm text-blue-800 mb-3">Reikalingas dokumentas: Susirinkimo protokolas arba raÅ¡ytiniai sutikimai (CK 4.75 str.)</p>
                  ${!state.files.coOwnerConsent ? `
                    <input type="file" id="coOwnerConsent" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileUpload('coOwnerConsent', this)" class="w-full">
                  ` : `
                    <div class="bg-white p-2 rounded flex justify-between items-center">
                      <span class="text-sm">${state.files.coOwnerConsent.name}</span>
                      <button onclick="removeFile('coOwnerConsent')" class="text-red-600">âœ•</button>
                    </div>
                  `}
                </div>
              ` : ''}
              
              ${state.data.hasCoOwnerConsent === 'no' ? `
                <div class="mt-4 p-4 bg-green-50 border border-green-200 rounded-lg">
                  <h4 class="font-semibold text-green-900 mb-1">âœ“ Sugeneruosime Å¡ablonus</h4>
                  <p class="text-sm text-green-800">Gausite 2 dokumentus: (1) BendrasavininkÅ³ sutikimo formÄ…, (2) Susirinkimo protokolo Å¡ablonÄ….</p>
                </div>
              ` : ''}
            </div>
          `;
        } else {
          formFields = `
            <div class="p-4 bg-green-50 border border-green-200 rounded-lg">
              <h4 class="font-semibold text-green-900 mb-1">âœ“ GraÅ¾usu!</h4>
              <p class="text-sm text-green-800">Individualiems namams nereikia bendrasavininkÅ³ sutikimo. Spausti "Generuoti dokumentus"!</p>
            </div>
          `;
        }
      }

      return `
        <div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50">
          <div class="bg-white border-b border-gray-200">
            <div class="max-w-4xl mx-auto px-4 py-4">
              <div class="flex items-center justify-between mb-4">
                <button onclick="changePage('landing')" class="flex items-center gap-2 text-gray-600 hover:text-gray-900">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                  </svg>
                  GrÄ¯Å¾ti
                </button>
                <div class="flex items-center gap-2">
                  <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                  </svg>
                  <span class="font-bold text-gray-900">EV Docs LT</span>
                </div>
              </div>
              
              <div class="flex items-center gap-2 mb-2">
                ${steps.map((_, idx) => `
                  <div class="flex-1">
                    <div class="h-2 rounded-full transition-all ${idx <= state.step ? 'bg-blue-600' : 'bg-gray-200'}"></div>
                  </div>
                  ${idx < steps.length - 1 ? `
                    <svg class="w-5 h-5 ${idx < state.step ? 'text-blue-600' : 'text-gray-300'}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path>
                    </svg>
                  ` : ''}
                `).join('')}
              </div>
              <div class="text-sm text-gray-600 text-center">
                Å½ingsnis ${state.step + 1} iÅ¡ ${steps.length}: ${currentStepData.title}
              </div>
            </div>
          </div>

          <div class="max-w-2xl mx-auto px-4 py-12">
            <div class="bg-white rounded-2xl shadow-lg p-8">
              <h2 class="text-2xl font-bold mb-6">${currentStepData.title}</h2>
              
              <div class="space-y-6">
                ${formFields}
              </div>

              <div class="flex gap-4 mt-8">
                ${state.step > 0 ? `
                  <button onclick="prevStep()" class="flex-1 bg-gray-100 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-200 transition-all">
                    â† Atgal
                  </button>
                ` : ''}
                
                <button onclick="nextStep()" class="flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-all">
                  ${state.step === steps.length - 1 ? 'Generuoti dokumentus' : 'Toliau'} â†’
                </button>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function renderResult() {
      const isApartment = state.data.propertyType === 'apartment';
      const isTenant = state.data.ownership === 'tenant';
      const needsCoOwnerDocs = isApartment && state.data.hasCoOwnerConsent === 'no';
      const hasCoOwnerDocs = isApartment && state.data.hasCoOwnerConsent === 'yes';

      return `
        <div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50">
          <nav class="bg-white border-b border-gray-200">
            <div class="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
              <div class="flex items-center gap-2">
                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                </svg>
                <span class="font-bold text-gray-900">EV Docs LT</span>
              </div>
              <button onclick="resetForm()" class="text-gray-600 hover:text-gray-900">Naujas projektas</button>
            </div>
          </nav>

          <div class="max-w-4xl mx-auto px-4 py-12">
            <div class="text-center mb-8">
              <div class="inline-flex items-center justify-center w-20 h-20 bg-green-100 rounded-full mb-4">
                <svg class="w-10 h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path>
                </svg>
              </div>
              <h1 class="text-4xl font-bold mb-3">Dokumentai sugeneruoti!</h1>
              <p class="text-xl text-gray-600">Sveikiname, ${state.data.fullName}! JÅ«sÅ³ dokumentai paruoÅ¡ti.</p>
            </div>

            <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
              <h2 class="text-2xl font-bold mb-6">ğŸ“¦ Sugeneruoti dokumentai</h2>
              
              <div class="space-y-4 mb-8">
                <div class="flex items-center gap-4 p-4 bg-gray-50 rounded-lg">
                  <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"></path>
                  </svg>
                  <div class="flex-1">
                    <h3 class="font-semibold">PareiÅ¡kimas</h3>
                    <p class="text-sm text-gray-600">${isApartment ? 'PraÅ¡ymas bendrasavininkams' : 'Informavimas apie Ä¯rengimÄ…'}</p>
                  </div>
                  <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path>
                  </svg>
                </div>
                
                ${needsCoOwnerDocs ? `
                  <div class="flex items-center gap-4 p-4 bg-gray-50 rounded-lg">
                    <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"></path>
                    </svg>
                    <div class="flex-1">
                      <h3 class="font-semibold">BendrasavininkÅ³ sutikimo forma</h3>
                      <p class="text-sm text-gray-600">ParaÅ¡Å³ rinkimo lentelÄ—</p>
                    </div>
                    <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path>
                    </svg>
                  </div>
                ` : ''}
              </div>

              <button onclick="downloadDocuments(event)" class="w-full bg-blue-600 text-white px-8 py-4 rounded-lg font-semibold text-lg hover:bg-blue-700 transition-all shadow-lg">
                â¬‡ï¸ AtsisiÅ³sti dokumentus (PDF)
              </button>
            </div>

            <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
              <h2 class="text-2xl font-bold mb-6">ğŸ“¤ Ä®kelkite kitus dokumentus</h2>
              <p class="text-gray-600 mb-6">Ä®kelkite visus reikalingus dokumentus. Å½emiau rasite instrukcijas, kaip juos gauti.</p>
              
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">1. NT registro iÅ¡raÅ¡as *</label>
                  ${!state.files.propertyDeed ? `
                    <div class="mb-2 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                      <p class="text-xs text-blue-900 font-semibold mb-1">ğŸ“ Kaip gauti:</p>
                      <p class="text-xs text-blue-800">â€¢ Internetu: <a href="https://www.registrucentras.lt/paslaugos" target="_blank" class="underline">www.registrucentras.lt/paslaugos</a></p>
                      <p class="text-xs text-blue-800">â€¢ Kaina: 2-3 EUR | TrukmÄ—: IÅ¡ karto</p>
                      <p class="text-xs text-blue-800">â€¢ Reikia prisijungti per el. valdÅ¾ios vartus</p>
                    </div>
                    <input type="file" id="propertyDeed" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileUpload('propertyDeed', this)" 
                      class="w-full p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 cursor-pointer">
                  ` : `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-3 flex items-center justify-between">
                      <span class="text-sm font-semibold">âœ“ ${state.files.propertyDeed.name}</span>
                      <button onclick="removeFile('propertyDeed')" class="text-red-600 hover:text-red-800">âœ•</button>
                    </div>
                  `}
                </div>

                ${hasCoOwnerDocs ? `
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">2. BendrasavininkÅ³ sutikimas *</label>
                  ${!state.files.coOwnerConsent ? `
                    <div class="mb-2 p-3 bg-purple-50 border border-purple-200 rounded-lg">
                      <p class="text-xs text-purple-900 font-semibold mb-1">ğŸ“‹ JÅ«sÅ³ turimas dokumentas:</p>
                      <p class="text-xs text-purple-800">â€¢ Susirinkimo protokolas ARBA</p>
                      <p class="text-xs text-purple-800">â€¢ VisÅ³ bendrasavininkÅ³ raÅ¡ytiniai sutikimai</p>
                      <p class="text-xs text-purple-800 mt-1">â€¢ Turi atitikti CK 4.75, 4.85 str.</p>
                    </div>
                    <input type="file" id="coOwnerConsent2" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileUpload('coOwnerConsent', this)" 
                      class="w-full p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 cursor-pointer">
                  ` : `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-3 flex items-center justify-between">
                      <span class="text-sm font-semibold">âœ“ ${state.files.coOwnerConsent.name}</span>
                      <button onclick="removeFile('coOwnerConsent')" class="text-red-600 hover:text-red-800">âœ•</button>
                    </div>
                  `}
                </div>
                ` : ''}

                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">${hasCoOwnerDocs ? '3' : '2'}. ESO prijungimo sÄ…lygos *</label>
                  ${!state.files.esoConditions ? `
                    <div class="mb-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                      <p class="text-xs text-yellow-900 font-semibold mb-1">âš¡ Kaip gauti:</p>
                      <p class="text-xs text-yellow-800">â€¢ Internetu: <a href="https://www.eso.lt" target="_blank" class="underline">www.eso.lt</a> â†’ Paslaugos â†’ Naujo objekto prijungimas</p>
                      <p class="text-xs text-yellow-800">â€¢ Tel.: 1852 (darbo dienomis 8-17 val.)</p>
                      <p class="text-xs text-yellow-800">â€¢ TrukmÄ—: 5-10 d.d. | Kaina: Nemokama</p>
                      <p class="text-xs text-yellow-800 mt-1">â€¢ Reikalingi dok.: PareiÅ¡kimas, NT iÅ¡raÅ¡as, EV specifikacija</p>
                    </div>
                    <input type="file" id="esoConditions" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileUpload('esoConditions', this)" 
                      class="w-full p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 cursor-pointer">
                  ` : `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-3 flex items-center justify-between">
                      <span class="text-sm font-semibold">âœ“ ${state.files.esoConditions.name}</span>
                      <button onclick="removeFile('esoConditions')" class="text-red-600 hover:text-red-800">âœ•</button>
                    </div>
                  `}
                </div>

                ${isTenant ? `
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">${hasCoOwnerDocs ? '4' : '3'}. Nuomotojo sutikimas *</label>
                  ${!state.files.landlordConsent ? `
                    <div class="mb-2 p-3 bg-orange-50 border border-orange-200 rounded-lg">
                      <p class="text-xs text-orange-900 font-semibold mb-1">ğŸ“ Kas reikalinga:</p>
                      <p class="text-xs text-orange-800">â€¢ RaÅ¡ytinis nuomotojo sutikimas Ä¯rengti stotelÄ™</p>
                      <p class="text-xs text-orange-800">â€¢ Nuomos sutarties kopija</p>
                      <p class="text-xs text-orange-800 mt-1">â€¢ Svarbu: Nuomos sutartis turi galioti ne trumpiau nei 4 metai!</p>
                    </div>
                    <input type="file" id="landlordConsent" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileUpload('landlordConsent', this)" 
                      class="w-full p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 cursor-pointer">
                  ` : `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-3 flex items-center justify-between">
                      <span class="text-sm font-semibold">âœ“ ${state.files.landlordConsent.name}</span>
                      <button onclick="removeFile('landlordConsent')" class="text-red-600 hover:text-red-800">âœ•</button>
                    </div>
                  `}
                </div>
                ` : ''}
              </div>

              ${allDocsUploaded() ? `
                <div class="mt-8">
                  <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                    <h3 class="font-bold text-green-900 mb-2">âœ“ Visi dokumentai Ä¯kelti!</h3>
                    <p class="text-sm text-green-800">Galite iÅ¡siÅ³sti dokumentus tiesiai Ä¯ ENA sistemÄ….</p>
                  </div>

                  <div class="flex gap-4">
                    <button onclick="downloadDocuments(event)" class="flex-1 bg-blue-600 text-white px-6 py-4 rounded-lg font-semibold hover:bg-blue-700 transition-all">
                      â¬‡ï¸ AtsisiÅ³sti PDF
                    </button>
                    <button onclick="sendToInstitutions(event)" class="flex-1 bg-green-600 text-white px-6 py-4 rounded-lg font-semibold hover:bg-green-700 transition-all">
                      ğŸ“§ SiÅ³sti Ä¯ ENA
                    </button>
                  </div>
                </div>
              ` : `
                <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                  <p class="text-sm text-blue-800"><strong>Liko Ä¯kelti:</strong> 
                    ${!state.files.propertyDeed ? 'NT iÅ¡raÅ¡as' : ''}
                    ${!state.files.propertyDeed && !state.files.esoConditions ? ', ' : ''}
                    ${!state.files.esoConditions ? 'ESO sÄ…lygos' : ''}
                    ${hasCoOwnerDocs && !state.files.coOwnerConsent ? ', Sutikimas' : ''}
                    ${isTenant && !state.files.landlordConsent ? ', Nuomotojo sutikimas' : ''}
                  </p>
                </div>
              `}
            </div>

            <div class="bg-gradient-to-r from-blue-600 to-green-600 rounded-2xl p-8 text-white">
              <h2 class="text-2xl font-bold mb-6">ğŸ¯ Pilnas proceso apraÅ¡ymas</h2>
              <div class="space-y-4">
                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-start gap-3">
                    <div class="bg-white text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">1</div>
                    <div>
                      <p class="font-bold text-lg mb-1">AtsisiÅ³skite sugeneruotus dokumentus</p>
                      <p class="text-sm text-blue-50">ğŸ“„ PDF faile rasite: PareiÅ¡kimÄ…${needsCoOwnerDocs ? ', BendrasavininkÅ³ sutikimo Å¡ablonÄ…' : ''} ir visas instrukcijas</p>
                      <p class="text-sm text-blue-50 mt-1">âœ“ Saugokite failus savo kompiuteryje</p>
                    </div>
                  </div>
                </div>

                ${needsCoOwnerDocs ? `
                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-start gap-3">
                    <div class="bg-white text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">2</div>
                    <div>
                      <p class="font-bold text-lg mb-1">Surinkite bendrasavininkÅ³ paraÅ¡us</p>
                      <p class="text-sm text-blue-50">ğŸ“‹ Naudokite PDF Å¡ablonÄ… arba suÅ¡aukite susirinkimÄ…</p>
                      <p class="text-sm text-blue-50">â±ï¸ TrukmÄ—: 1-4 savaitÄ—s (priklauso nuo bendrasavininkÅ³ aktyvumo)</p>
                      <p class="text-sm text-blue-50 mt-1">ğŸ’¡ Patarimas: SiÅ«lykite bendrÄ… susirinkimÄ… - greiÄiau!</p>
                    </div>
                  </div>
                </div>
                ` : ''}

                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-start gap-3">
                    <div class="bg-white text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">${needsCoOwnerDocs ? '3' : '2'}</div>
                    <div>
                      <p class="font-bold text-lg mb-1">Gaukite NT registro iÅ¡raÅ¡Ä…</p>
                      <p class="text-sm text-blue-50">ğŸŒ <a href="https://www.registrucentras.lt/paslaugos" target="_blank" class="underline">www.registrucentras.lt/paslaugos</a></p>
                      <p class="text-sm text-blue-50">ğŸ’¶ Kaina: 2-3 EUR | â±ï¸ TrukmÄ—: IÅ¡ karto (el. formatu)</p>
                      <p class="text-sm text-blue-50 mt-1">ğŸ”‘ Reikia prisijungti per el. valdÅ¾ios vartus</p>
                    </div>
                  </div>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-start gap-3">
                    <div class="bg-white text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">${needsCoOwnerDocs ? '4' : '3'}</div>
                    <div>
                      <p class="font-bold text-lg mb-1">KreipkitÄ—s Ä¯ ESO dÄ—l prijungimo sÄ…lygÅ³</p>
                      <p class="text-sm text-blue-50">ğŸŒ <a href="https://www.eso.lt" target="_blank" class="underline">www.eso.lt</a> â†’ Paslaugos â†’ Naujo objekto prijungimas</p>
                      <p class="text-sm text-blue-50">ğŸ“ Tel.: 1852 | â±ï¸ TrukmÄ—: 5-10 d.d. | ğŸ’¶ Nemokama</p>
                      <p class="text-sm text-blue-50 mt-1">ğŸ“‹ ReikÄ—s: PareiÅ¡kimo, NT iÅ¡raÅ¡o, EV stotelÄ—s specifikacijos</p>
                    </div>
                  </div>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-start gap-3">
                    <div class="bg-white text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">${needsCoOwnerDocs ? '5' : '4'}</div>
                    <div>
                      <p class="font-bold text-lg mb-1">Pasirinkite rangovÄ… su VERT atestu</p>
                      <p class="text-sm text-blue-50">ğŸ”§ PavyzdÅ¾iai: Charge In (+370 612 77700), Solet Technics (+370 614 51775)</p>
                      <p class="text-sm text-blue-50">ğŸŒ Daugiau: <a href="https://www.vert.lt" target="_blank" class="underline">www.vert.lt</a> (atestuotÅ³ elektrikÅ³ sÄ…raÅ¡as)</p>
                      <p class="text-sm text-blue-50 mt-1">ğŸ’¡ Gaukite bent 2-3 pasiÅ«lymus - palyginkite kainas!</p>
                    </div>
                  </div>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-start gap-3">
                    <div class="bg-white text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">${needsCoOwnerDocs ? '6' : '5'}</div>
                    <div>
                      <p class="font-bold text-lg mb-1">Pateikite paraiÅ¡kÄ… ENA paramai (PRIEÅ  Ä¯rengimÄ…!)</p>
                      <p class="text-sm text-blue-50">ğŸŒ <a href="https://www.ena.lt" target="_blank" class="underline">www.ena.lt</a> â†’ Parama â†’ EV stotelÄ—s</p>
                      <p class="text-sm text-blue-50">â±ï¸ Laukimo laikas: 5-10 d.d.</p>
                      <p class="text-sm text-blue-50 mt-1">âš ï¸ SVARBU: ParaiÅ¡kÄ… BÅªTINA pateikti PRIEÅ  Ä¯rengimÄ…!</p>
                    </div>
                  </div>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                  <div class="flex items-start gap-3">
                    <div class="bg-white text-blue-600 rounded-full w-8 h-8 flex items-center justify-center font-bold flex-shrink-0">${needsCoOwnerDocs ? '7' : '6'}</div>
                    <div>
                      <p class="font-bold text-lg mb-1">Ä®renkite stotelÄ™ ir pateikite dokumentus paramai</p>
                      <p class="text-sm text-blue-50">Po Ä¯rengimo pateikite ENA: PVM sÄ…skaitÄ…, perdavimo aktÄ…, bandymo protokolus</p>
                      <p class="text-sm text-blue-50 mt-2">ğŸ’° <span class="text-yellow-300 font-bold">Gausite: ${isApartment ? '60%' : '40%'} kompensacijÄ… (maks. 1,500 EUR)</span></p>
                      <p class="text-sm text-blue-50">â±ï¸ Paramos iÅ¡mokÄ—jimas: 1-2 mÄ—nesiai po dokumentÅ³ pateikimo</p>
                    </div>
                  </div>
                </div>

                <div class="mt-4 bg-yellow-400/20 border-2 border-yellow-300 rounded-lg p-4">
                  <p class="font-bold text-lg mb-2">âš ï¸ SVARBU - Paramos programa</p>
                  <p class="text-sm text-blue-50">â€¢ Programa galioja iki 2025 m. rugsÄ—jo mÄ—n. (tikslinkite ENA!)</p>
                  <p class="text-sm text-blue-50">â€¢ Parama skiriama tik jei paraiÅ¡ka pateikta PRIEÅ  Ä¯rengimÄ…</p>
                  <p class="text-sm text-blue-50">â€¢ LÄ—Å¡os ribotos - verta skubÄ—ti!</p>
                </div>
              </div>
            </div>
            <div class="mt-8 bg-white rounded-2xl shadow-lg p-8">
              <h2 class="text-2xl font-bold mb-6">ğŸ“ Naudingi kontaktai</h2>
              <div class="grid md:grid-cols-2 gap-6">
                <div class="border border-gray-200 rounded-lg p-4">
                  <h3 class="font-bold text-lg mb-2 text-blue-600">ğŸ›ï¸ Energetikos agentÅ«ra (ENA)</h3>
                  <p class="text-sm text-gray-600 mb-2">Paramos administravimas</p>
                  <p class="text-sm">ğŸŒ <a href="https://www.ena.lt" target="_blank" class="text-blue-600 underline">www.ena.lt</a></p>
                  <p class="text-sm">ğŸ“§ info@ena.lt</p>
                  <p class="text-sm">ğŸ“ +370 5 263 9823</p>
                </div>

                <div class="border border-gray-200 rounded-lg p-4">
                  <h3 class="font-bold text-lg mb-2 text-yellow-600">âš¡ ESO (Elektros tinklai)</h3>
                  <p class="text-sm text-gray-600 mb-2">Prijungimo sÄ…lygos</p>
                  <p class="text-sm">ğŸŒ <a href="https://www.eso.lt" target="_blank" class="text-blue-600 underline">www.eso.lt</a></p>
                  <p class="text-sm">ğŸ“ 1852 (darbo d. 8-17 val.)</p>
                  <p class="text-sm">ğŸ“§ info@eso.lt</p>
                </div>

                <div class="border border-gray-200 rounded-lg p-4">
                  <h3 class="font-bold text-lg mb-2 text-green-600">ğŸ“‹ RegistrÅ³ centras</h3>
                  <p class="text-sm text-gray-600 mb-2">NT registro iÅ¡raÅ¡ai</p>
                  <p class="text-sm">ğŸŒ <a href="https://www.registrucentras.lt" target="_blank" class="text-blue-600 underline">www.registrucentras.lt</a></p>
                  <p class="text-sm">ğŸ“ 1884 (darbo d. 8-17 val.)</p>
                  <p class="text-sm">ğŸ“§ info@registrucentras.lt</p>
                </div>

                <div class="border border-gray-200 rounded-lg p-4">
                  <h3 class="font-bold text-lg mb-2 text-purple-600">ğŸ”§ VERT (Elektros Ä¯renginiai)</h3>
                  <p class="text-sm text-gray-600 mb-2">Atestuoti rangovai</p>
                  <p class="text-sm">ğŸŒ <a href="https://www.vert.lt" target="_blank" class="text-blue-600 underline">www.vert.lt</a></p>
                  <p class="text-sm">ğŸ“ +370 5 213 1165</p>
                  <p class="text-sm">ğŸ“§ info@vert.lt</p>
                </div>
              </div>

              <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                <h3 class="font-bold mb-2">ğŸ› ï¸ Rekomenduojami rangovai:</h3>
                <div class="grid md:grid-cols-3 gap-4 text-sm">
                  <div>
                    <p class="font-semibold">Charge In</p>
                    <p class="text-gray-600">ğŸ“ +370 612 77700</p>
                    <p class="text-gray-600">ğŸŒ <a href="https://www.chargein.lt" target="_blank" class="text-blue-600 underline">chargein.lt</a></p>
                  </div>
                  <div>
                    <p class="font-semibold">Solet Technics</p>
                    <p class="text-gray-600">ğŸ“ +370 614 51775</p>
                    <p class="text-gray-600">ğŸŒ <a href="https://www.solet.lt" target="_blank" class="text-blue-600 underline">solet.lt</a></p>
                  </div>
                  <div>
                    <p class="font-semibold">Elektrum</p>
                    <p class="text-gray-600">ğŸ“ +370 700 32200</p>
                    <p class="text-gray-600">ğŸŒ <a href="https://www.elektrum.lt" target="_blank" class="text-blue-600 underline">elektrum.lt</a></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    // Event handlers
    function changePage(page) {
      state.page = page;
      render();
    }

    function updateData(field, value) {
      state.data[field] = value;
      if (state.errors[field]) {
        delete state.errors[field];
      }
      render();
    }

    function nextStep() {
      if (validateStep()) {
        if (state.step < steps.length - 1) {
          state.step++;
          render();
        } else {
          state.page = 'result';
          render();
        }
      } else {
        render();
      }
    }

    function prevStep() {
      if (state.step > 0) {
        state.step--;
        render();
      }
    }

    function handleFileUpload(fileType, input) {
      const file = input.files[0];
      if (file) {
        if (file.size > 10 * 1024 * 1024) {
          alert('Failas per didelis! Maksimalus dydis: 10MB');
          input.value = '';
          return;
        }
        state.files[fileType] = file;
        render();
      }
    }

    function removeFile(fileType) {
      state.files[fileType] = null;
      render();
    }

    function resetForm() {
      state = {
        page: 'landing',
        step: 0,
        errors: {},
        files: { propertyDeed: null, coOwnerConsent: null, esoConditions: null, landlordConsent: null },
        data: {
          fullName: '', personalCode: '', phone: '', email: '', address: '', apartmentNumber: '',
          propertyType: '', ownership: '', parkingSpot: '', parkingLocation: '', chargerType: '',
          power: '', connectors: '1', chargerModel: '', hasCoOwnerConsent: ''
        }
      };
      render();
    }

    // Main render
    function render() {
      const app = document.getElementById('app');
      if (state.page === 'landing') {
        app.innerHTML = renderLanding();
      } else if (state.page === 'form') {
        app.innerHTML = renderForm();
      } else if (state.page === 'result') {
        app.innerHTML = renderResult();
      }
    }

    // Initial render
    render();
  </script>
</body>
</html>
